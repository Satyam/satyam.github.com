<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns:yui="http://yuilibrary.com/rdf/1.0/yui.rdf#">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>API: recordset   record.js  (YUI Library)</title>

	<link rel="stylesheet" type="text/css" href="assets/reset-fonts-grids-min.css?stamp=1285452587.44" />
	<link rel="stylesheet" type="text/css" href="assets/api.css?stamp=1285452587.44" />

    <script type="text/javascript" src="assets/api-js?stamp=1285452587.44"></script>
    <script type="text/javascript" src="assets/ac-js?stamp=1285452587.44"></script>
</head>

<body id="yahoo-com">

<div id="doc3" class="yui-t2">
	<div id="hd">
        <h1><a href="http://developer.yahoo.com/yui/" title="Yahoo! UI Library">Yahoo! UI Library</a></h1>
        <h3>recordset&nbsp; <span class="subtitle">1.0</span></h3>
        <a href="./index.html" title="Yahoo! UI Library">Yahoo! UI Library</a> 
            &gt; <a href="./module_recordset.html" title="recordset">recordset</a>
                
                 &gt; record.js (source view) 
        <form onsubmit="return false">
            <div id="propertysearch">
                Search: <input autocomplete="off" id="searchinput" />
                <div id="searchresults">
                    &nbsp;
                </div>
            </div>
        </form>
	</div>

	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">
            <form action="#" name="yui-classopts-form" method="get" id="yui-classopts-form">
                <fieldset>
                    <legend>Filters</legend>
                <span class="classopts"><input type="checkbox" name="show_private" id="show_private" /> <label for="show_private">Show Private</label></span>
                <span class="classopts"><input type="checkbox" name="show_protected" id="show_protected" /> <label for="show_protected">Show Protected</label></span>
                <span class="classopts"><input type="checkbox" name="show_deprecated" id="show_deprecated" /> <label for="show_deprecated">Show Deprecated</label></span>
                </fieldset>
            </form>

                    <div id="srcout">
                        <style>
                            #doc3 .classopts { display:none; }
                        </style>
<div class="highlight"><pre><span class="c">/**</span>
<span class="c"> * The recordset module provides a standard way to store tabular data, load it from any DataSource</span>
<span class="c"> * and serialize it in several formats.  It can also keep meta-information about that data</span>
<span class="c"> * such as parsers, formatters and labels</span>
<span class="c"> * @module recordset</span>
<span class="c"> */</span>

<span class="nx">YUI</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;recordset&#39;</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">Lang</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Lang</span><span class="o">,</span>
		<span class="nx">getClassName</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">ClassNameManager</span><span class="p">.</span><span class="nx">getClassName</span><span class="o">,</span>

	
		<span class="nx">FIELD_DEF</span> <span class="o">=</span> <span class="s1">&#39;FieldDef&#39;</span><span class="o">,</span>
		<span class="nx">FIELD_DEF_SET</span> <span class="o">=</span> <span class="s1">&#39;FieldDefSet&#39;</span><span class="o">,</span>
		<span class="nx">FIELD</span> <span class="o">=</span> <span class="s1">&#39;Field&#39;</span><span class="o">,</span>
		<span class="nx">RECORD</span> <span class="o">=</span> <span class="s1">&#39;Record&#39;</span><span class="o">,</span>
		<span class="nx">RECORDSET</span> <span class="o">=</span> <span class="s1">&#39;RecordSet&#39;</span><span class="o">,</span>
		<span class="nx">NEW</span> <span class="o">=</span> <span class="s1">&#39;new&#39;</span><span class="o">,</span>
		<span class="nx">DIRTY</span> <span class="o">=</span> <span class="s1">&#39;dirty&#39;</span><span class="o">,</span>
		<span class="nx">DELETED</span> <span class="o">=</span> <span class="s1">&#39;deleted&#39;</span><span class="o">,</span>
		<span class="nx">JOINT</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">,</span>
		
		<span class="nx">NAME</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span><span class="o">,</span>
		<span class="nx">DATASOURCE</span> <span class="o">=</span> <span class="s1">&#39;dataSource&#39;</span><span class="o">,</span>
		<span class="nx">SERIALIZE_FORMAT</span> <span class="o">=</span> <span class="s1">&#39;serializeFormat&#39;</span><span class="o">,</span>
		<span class="nx">SERIALIZE_DIRTY_ONLY</span> <span class="o">=</span> <span class="s1">&#39;serializeDirtyOnly&#39;</span><span class="o">,</span>
		<span class="nx">PRIMARY_KEY</span> <span class="o">=</span> <span class="s1">&#39;primaryKey&#39;</span><span class="o">,</span>
		<span class="nx">SORTED_BY</span> <span class="o">=</span> <span class="s1">&#39;sortedBy&#39;</span><span class="o">,</span>
		<span class="nx">SORT_COMPARE</span> <span class="o">=</span> <span class="s1">&#39;sortCompareFunction&#39;</span><span class="o">,</span>
		<span class="nx">TYPE</span> <span class="o">=</span> <span class="s1">&#39;type&#39;</span><span class="o">,</span>
		<span class="nx">SERVER</span> <span class="o">=</span> <span class="s1">&#39;server&#39;</span><span class="o">,</span>
		<span class="nx">UI</span> <span class="o">=</span> <span class="s1">&#39;ui&#39;</span><span class="o">,</span>
		<span class="nx">CHILDREN</span> <span class="o">=</span> <span class="s1">&#39;children&#39;</span><span class="o">,</span>
		<span class="nx">ROOT</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span><span class="o">,</span>
		<span class="nx">PARENT</span> <span class="o">=</span> <span class="s1">&#39;parent&#39;</span><span class="o">,</span>
		<span class="nx">VALUE</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span><span class="o">,</span>
		<span class="nx">OLD_VALUE</span> <span class="o">=</span> <span class="s1">&#39;oldValue&#39;</span><span class="o">,</span>
		<span class="nx">INITIAL_VALUE</span> <span class="o">=</span> <span class="s1">&#39;initialValue&#39;</span><span class="o">,</span>
		
		<span class="nx">TRAVERSE_DEEP</span> <span class="o">=</span> <span class="s1">&#39;traverseDeep&#39;</span><span class="o">,</span>
		<span class="nx">TRAVERSE_SHALLOW</span> <span class="o">=</span> <span class="s1">&#39;traverseShallow&#39;</span><span class="o">,</span>
		<span class="nx">TRAVERSE_LEAVES</span> <span class="o">=</span> <span class="s1">&#39;traverseLeaves&#39;</span><span class="o">,</span>
		
		<span class="nx">LOAD_DATA_EVENT</span> <span class="o">=</span> <span class="s1">&#39;loadData&#39;</span><span class="o">,</span>
		<span class="nx">LOAD_FAIL_EVENT</span> <span class="o">=</span> <span class="s1">&#39;loadFail&#39;</span><span class="o">,</span>
		
		<span class="nx">INFO</span> <span class="o">=</span> <span class="s1">&#39;info&#39;</span><span class="o">,</span>
		<span class="nx">WARN</span> <span class="o">=</span> <span class="s1">&#39;warn&#39;</span><span class="o">,</span>
		<span class="nx">ERROR</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span><span class="o">;</span>
	<span class="c">/**</span>
<span class="c">	 * Stores definitions for a field</span>
<span class="c">	 * @class FieldDef</span>
<span class="c">	 * @uses Y.Attribute</span>
<span class="c">	 */</span>
	<span class="kd">var</span> <span class="nx">FieldDefSet</span><span class="o">;</span> <span class="c">// Just to avoid a forward reference</span>
	<span class="kd">var</span> <span class="nx">FieldDef</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
		<span class="nx">FIELD_DEF</span><span class="o">,</span>
		<span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="o">,</span>
		<span class="p">[]</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Reference to the parent of this definition or null if none</span>
<span class="c">			 * @property _parent</span>
<span class="c">			 * @type FieldDef</span>
<span class="c">			 * @default null</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_parent</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
			<span class="c">/** </span>
<span class="c">			 * Reference to the top-most field definition or to itself if at the top</span>
<span class="c">			 * @property _root</span>
<span class="c">			 * @type FieldDef</span>
<span class="c">			 * @default null</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_root</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Adds a child item to the array of children at the given index or at the end of none</span>
<span class="c">			 * @method add</span>
<span class="c">			 * @param item {FieldDef or object} Definition to be added</span>
<span class="c">			 * @param index {integer} (optional) Position to add the definition</span>
<span class="c">			 */</span>
			<span class="nx">add</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="o">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">children</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">CHILDREN</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">children</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">item</span><span class="o">,</span> <span class="nx">index</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Returns the number of children under this defition</span>
<span class="c">			 * @method getChildCount</span>
<span class="c">			 * @return {integer} Number of children</span>
<span class="c">			 */</span>
			<span class="nx">getChildCount</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">children</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">CHILDREN</span><span class="p">);</span>
				<span class="k">return</span> <span class="p">(</span><span class="nx">children</span> <span class="o">&amp;&amp;</span> <span class="nx">children</span><span class="p">.</span><span class="nx">size</span><span class="p">())</span> <span class="o">||</span> <span class="mi">0</span><span class="o">;</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="nx">ATTRS</span><span class="o">:</span> <span class="p">{</span>
				<span class="c">/**</span>
<span class="c">				 * Name of the field for this definition. </span>
<span class="c">				 * @attribute name</span>
<span class="c">				 * @type string</span>
<span class="c">				 * @default null</span>
<span class="c">				 */</span>
				<span class="nx">name</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="o">,</span>
					<span class="nx">lazyAdd</span><span class="o">:</span><span class="kc">false</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Label to be shown for this field (defaults to field name)</span>
<span class="c">				 * @attribute label</span>
<span class="c">				 * @type string</span>
<span class="c">				 * @default null</span>
<span class="c">				 */</span>
				<span class="kd">label</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="o">,</span>
					<span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">return</span> <span class="nx">value</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NAME</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Provided as an internal-use setting to read the parent of this node</span>
<span class="c">				 * even before the initializer method gets called.</span>
<span class="c">				 * The parent is required to find out the root, which is used in setting some of the other attributes</span>
<span class="c">				 * @attribute _parent</span>
<span class="c">				 * @type FieldDef</span>
<span class="c">				 * @private</span>
<span class="c">				 */</span>
				<span class="nx">_parent</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_parent</span> <span class="o">=</span> <span class="nx">value</span><span class="o">;</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_root</span> <span class="o">=</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span><span class="p">.</span><span class="nx">_root</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="o">;</span>
						<span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Attribute</span><span class="p">.</span><span class="nx">INVALID_VALUE</span><span class="o">;</span>
						
					<span class="p">}</span><span class="o">,</span>
					<span class="nx">lazyAdd</span><span class="o">:</span><span class="kc">false</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Reference to the parent of this definition</span>
<span class="c">				 * @attribute parent</span>
<span class="c">				 * @type FieldDef</span>
<span class="c">				 * @readOnly</span>
<span class="c">				 */</span>
				<span class="nx">parent</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">readOnly</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span>
					<span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
						<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_parent</span><span class="o">;</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Reference to the top-most definition containing this definition</span>
<span class="c">				 * @attribute root</span>
<span class="c">				 * @type FieldDef</span>
<span class="c">				 * @readOnly</span>
<span class="c">				 */</span>
				<span class="nx">root</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">readOnly</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span>
					<span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
						<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_root</span><span class="o">;</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				
				<span class="c">/**</span>
<span class="c">				 * Definitions of fields group under this field</span>
<span class="c">				 * @attribute children</span>
<span class="c">				 * @type FieldDefs</span>
<span class="c">				 * @default null</span>
<span class="c">				 */</span>
				<span class="nx">children</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">TYPE</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;server.parser&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;server.formatter&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;ui.parser&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;ui.formatter&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">INITIAL_VALUE</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">PRIMARY_KEY</span><span class="p">))</span> <span class="p">{</span>
							<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Can&#39;t define &#39;children&#39; on fields that already have a &#39;type&#39;, &#39;server&#39;, &#39;ui&#39;, &#39;initialValue&#39; or &#39;primaryKey&#39; defined&quot;</span><span class="o">,</span> <span class="nx">ERROR</span><span class="o">,</span> <span class="nx">FIELD_DEF</span><span class="p">);</span>
							<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
					<span class="p">}</span><span class="o">,</span>
					<span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isNull</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Attribute</span><span class="p">.</span><span class="nx">INVALID_VALUE</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="k">instanceof</span> <span class="nx">FieldDefSet</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">FieldDefSet</span><span class="p">.</span><span class="nx">_parent</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
							<span class="k">return</span> <span class="nx">value</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="k">return</span> <span class="k">new</span> <span class="nx">FieldDefSet</span><span class="p">(</span><span class="nx">value</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
					<span class="p">}</span><span class="o">,</span>
					<span class="nx">lazyAdd</span><span class="o">:</span><span class="kc">false</span>
				<span class="p">}</span><span class="o">,</span>
					
				<span class="c">/**</span>
<span class="c">				 * Formatting and parsing functions for exchanging data with the server</span>
<span class="c">				 * @attribute server</span>
<span class="c">				 * @type {object}</span>
<span class="c">				 */</span>
				<span class="nx">server</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span> <span class="p">{</span>
						<span class="c">/**</span>
<span class="c">						 * Function to be used for parsing the field when it is received from the server</span>
<span class="c">						 * @attribute server.parser</span>
<span class="c">						 * @type function or null</span>
<span class="c">						 * @default null</span>
<span class="c">						 */</span>
						<span class="nx">parser</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
						<span class="c">/**</span>
<span class="c">						 * Function to be used for formatting the field value when it is sent to the server</span>
<span class="c">						 * @attribute server.formatter</span>
<span class="c">						 * @type function or null</span>
<span class="c">						 * @default null</span>
<span class="c">						 */</span>
						<span class="nx">formatter</span><span class="o">:</span><span class="kc">null</span>
					<span class="p">}</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="o">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">CHILDREN</span><span class="p">))</span> <span class="p">{</span>
							<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Can&#39;t set attribute &#39;server&#39; on a field with children&quot;</span><span class="o">,</span><span class="nx">ERROR</span><span class="o">,</span> <span class="nx">FIELD_DEF</span><span class="p">);</span>
							<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="kd">var</span> <span class="nx">check</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
							<span class="k">return</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNull</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isFunction</span> <span class="p">(</span><span class="nx">fn</span><span class="p">);</span>
						<span class="p">};</span>
						<span class="nx">switch</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">case</span> <span class="s1">&#39;server&#39;</span><span class="o">:</span>
								<span class="k">return</span> <span class="p">(</span><span class="s1">&#39;parser&#39;</span> <span class="k">in</span> <span class="nx">value</span><span class="o">?</span><span class="nx">check</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">parser</span><span class="p">)</span><span class="o">:</span><span class="kc">true</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="s1">&#39;formatter&#39;</span> <span class="k">in</span> <span class="nx">value</span><span class="o">?</span> <span class="nx">check</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">formatter</span><span class="p">)</span><span class="o">:</span><span class="kc">true</span><span class="p">);</span>
							<span class="nx">case</span> <span class="s1">&#39;server.parser&#39;</span><span class="o">:</span>
								<span class="k">return</span> <span class="nx">check</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">parser</span><span class="p">);</span>
							<span class="nx">case</span> <span class="s1">&#39;server.formatter&#39;</span><span class="o">:</span>
								<span class="k">return</span> <span class="nx">check</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">formatter</span><span class="p">);</span>
							<span class="nx">default</span><span class="o">:</span>
								<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Formatting and parsing functions for exchanging data with the user</span>
<span class="c">				 * @attribute ui</span>
<span class="c">				 * @type {object}</span>
<span class="c">				 */</span>
				<span class="nx">ui</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span> <span class="p">{</span>
						<span class="c">/**</span>
<span class="c">						 * Function to be used for parsing the field when it is received from some user input component</span>
<span class="c">						 * @attribute ui.parser</span>
<span class="c">						 * @type function or null</span>
<span class="c">						 * @default null</span>
<span class="c">						 */</span>
						<span class="nx">parser</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
						<span class="c">/**</span>
<span class="c">						 * Function to be used for formatting the field value when it is presented to the user</span>
<span class="c">						 * @attribute ui.formatter</span>
<span class="c">						 * @type function or null</span>
<span class="c">						 * @default null</span>
<span class="c">						 */</span>
						<span class="nx">formatter</span><span class="o">:</span><span class="kc">null</span>
					<span class="p">}</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="o">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">CHILDREN</span><span class="p">))</span> <span class="p">{</span>
							<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Can&#39;t set attribute &#39;ui&#39; on a field with children&quot;</span><span class="o">,</span><span class="nx">ERROR</span><span class="o">,</span> <span class="nx">FIELD_DEF</span><span class="p">);</span>
							<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="kd">var</span> <span class="nx">check</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
							<span class="k">return</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNull</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isFunction</span> <span class="p">(</span><span class="nx">fn</span><span class="p">);</span>
						<span class="p">};</span>
						<span class="nx">switch</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">case</span> <span class="s1">&#39;ui&#39;</span><span class="o">:</span>
								<span class="k">return</span> <span class="p">(</span><span class="s1">&#39;parser&#39;</span> <span class="k">in</span> <span class="nx">value</span><span class="o">?</span><span class="nx">check</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">parser</span><span class="p">)</span><span class="o">:</span><span class="kc">true</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="s1">&#39;formatter&#39;</span> <span class="k">in</span> <span class="nx">value</span><span class="o">?</span> <span class="nx">check</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">formatter</span><span class="p">)</span><span class="o">:</span><span class="kc">true</span><span class="p">);</span>
							<span class="nx">case</span> <span class="s1">&#39;ui.parser&#39;</span><span class="o">:</span>
								<span class="k">return</span> <span class="nx">check</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">parser</span><span class="p">);</span>
							<span class="nx">case</span> <span class="s1">&#39;ui.formatter&#39;</span><span class="o">:</span>
								<span class="k">return</span> <span class="nx">check</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">formatter</span><span class="p">);</span>
							<span class="nx">default</span><span class="o">:</span>
								<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * DataType information.  It should be a reference to any of the types stored in DataType.Types</span>
<span class="c">				 * @attribute type</span>
<span class="c">				 * @type string</span>
<span class="c">				 * @default null</span>
<span class="c">				 */</span>
				<span class="nx">type</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">CHILDREN</span><span class="p">))</span> <span class="p">{</span>
							<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Can&#39;t set attribute &#39;type&#39; on a field with children&quot;</span><span class="o">,</span><span class="nx">ERROR</span><span class="o">,</span> <span class="nx">FIELD_DEF</span><span class="p">);</span>
							<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="k">return</span> <span class="nx">value</span> <span class="k">in</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span><span class="o">;</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Signals that the field is a primary key.</span>
<span class="c">				 * Fields marked as being a primaryKey will be indexed and can be used to &lt;a href=&quot;RecordSet.html#method_search&quot;&gt;&lt;code&gt;search&lt;/code&gt;&lt;/a&gt; for Records</span>
<span class="c">				 * They will also be included in any serialized output even when not dirty</span>
<span class="c">				 * @attribute primaryKey</span>
<span class="c">				 * @type Boolean</span>
<span class="c">				 * @default false</span>
<span class="c">				 */</span>
				<span class="nx">primaryKey</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="kc">false</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">CHILDREN</span><span class="p">))</span> <span class="p">{</span>
							<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Can&#39;t set attribute &#39;primaryKey&#39; on a field with children&quot;</span><span class="o">,</span><span class="nx">ERROR</span><span class="o">,</span> <span class="nx">FIELD_DEF</span><span class="p">);</span>
							<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="k">return</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
					<span class="p">}</span><span class="o">,</span>
					<span class="nx">broadcast</span><span class="o">:</span><span class="mi">1</span><span class="o">,</span>
					<span class="nx">lazyAdd</span><span class="o">:</span> <span class="kc">false</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Initial value for a field when no value is provided.</span>
<span class="c">				 * @attribute initialValue</span>
<span class="c">				 * @type any</span>
<span class="c">				 * @default null</span>
<span class="c">				 */</span>
				<span class="nx">initialValue</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">CHILDREN</span><span class="p">))</span> <span class="p">{</span>
							<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Can&#39;t set attribute &#39;initialValue&#39; on a field with children&quot;</span><span class="o">,</span><span class="nx">ERROR</span><span class="o">,</span> <span class="nx">FIELD_DEF</span><span class="p">);</span>
							<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
					<span class="p">}</span>					
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Function to sort records by when sorted by this field.  </span>
<span class="c">				 * If none provided (the default) the sortCompareFunction attribute </span>
<span class="c">				 * for the whole RecordSet will be used and finally the regular lexical comparison.</span>
<span class="c">				 * The function will receive:&lt;/ol&gt;</span>
<span class="c">				 * &lt;li&gt;&lt;code&gt;a&lt;/code&gt;: first record to compare&lt;/li&gt;</span>
<span class="c">				 * &lt;li&gt;&lt;code&gt;b&lt;/code&gt;: second record to compare&lt;/li&gt;</span>
<span class="c">				 * &lt;li&gt;&lt;code&gt;desc&lt;/code&gt;: Boolean indicating the sort should be in descending order</span>
<span class="c">				 * &lt;li&gt;&lt;code&gt;fieldName&lt;/code&gt;: Name of the field to sort by</span>
<span class="c">				 * &lt;/ol&gt;</span>
<span class="c">				 * @attribute sortCompareFunction</span>
<span class="c">				 * @type function or null</span>
<span class="c">				 * @default null.</span>
<span class="c">				 */</span>
				<span class="nx">sortCompareFunction</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">return</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNull</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span>
				
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">);</span>
	<span class="nx">Y</span><span class="p">[</span><span class="nx">FIELD_DEF</span><span class="p">]</span> <span class="o">=</span> <span class="nx">FieldDef</span><span class="o">;</span>
	
	<span class="c">/**</span>
<span class="c">	 * Collection of FieldDef instances</span>
<span class="c">	 * @class FieldDefSet</span>
<span class="c">	 * @constructor</span>
<span class="c">	 * @param defs {FieldDef or object} Initial set of definitions</span>
<span class="c">	 * @param _parent {FieldDef} (private) Reference to the parent definition of this collection</span>
<span class="c">	 */</span>
	<span class="nx">FieldDefSet</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">defs</span><span class="o">,</span> <span class="nx">_parent</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">this</span><span class="p">.</span><span class="nx">_init</span><span class="p">(</span><span class="nx">defs</span><span class="o">,</span> <span class="nx">_parent</span><span class="p">);</span>
	<span class="p">};</span>
	
	<span class="nx">FieldDefSet</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>
		<span class="c">/**</span>
<span class="c">		 * Reference to the top-most FieldDefSet instance</span>
<span class="c">		 * @property _root</span>
<span class="c">		 * @type FieldDefs</span>
<span class="c">		 * @default null</span>
<span class="c">		 * @private</span>
<span class="c">		 */</span>
		<span class="nx">_root</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Reference to the FieldDef instance this set is a child of</span>
<span class="c">		 * @property _parent</span>
<span class="c">		 * @type FieldDef</span>
<span class="c">		 * @default null</span>
<span class="c">		 * @private</span>
<span class="c">		 */</span>
		 <span class="nx">_parent</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Array containing the names of the fields in this level. </span>
<span class="c">		 * It is this array that gives the order of the fields when traversing them</span>
<span class="c">		 * @property _items</span>
<span class="c">		 * @type [strings]</span>
<span class="c">		 * @default []</span>
<span class="c">		 * @private</span>
<span class="c">		 */</span>
		<span class="nx">_items</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Collection of FieldDef indexed by name.  Valid only on the root FieldDefSet.</span>
<span class="c">		 * @propery _keys</span>
<span class="c">		 * @type object</span>
<span class="c">		 * @default {}</span>
<span class="c">		 * @private</span>
<span class="c">		 */</span>
		<span class="nx">_keys</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
		
		<span class="c">/**</span>
<span class="c">		 * Number of levels of nesting. Valid only on the root FieldDefSet.</span>
<span class="c">		 * @propery _totalDepth</span>
<span class="c">		 * @type integer</span>
<span class="c">		 * @default 0</span>
<span class="c">		 * @private</span>
<span class="c">		 */</span>
		<span class="nx">_totalDepth</span><span class="o">:</span><span class="mi">0</span><span class="o">,</span>
	
		<span class="c">/**</span>
<span class="c">		 * Initialization method (called by constructor)</span>
<span class="c">		 * @method _init</span>
<span class="c">		 * @param defs {FieldDef or object} Initial set of definitions</span>
<span class="c">		 * @param _parent {FieldDef} (private) Reference to the parent definition of this collection</span>
<span class="c">		 */</span>
		<span class="nx">_init</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">defs</span><span class="o">,</span> <span class="nx">_parent</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">_items</span> <span class="o">=</span> <span class="p">[];</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">_keys</span> <span class="o">=</span> <span class="p">{};</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">_parent</span> <span class="o">=</span> <span class="nx">_parent</span> <span class="o">||</span> <span class="kc">null</span><span class="o">;</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">_root</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_parent</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_parent</span><span class="p">.</span><span class="nx">_root</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="o">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">depth</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span><span class="nx">self</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">_root</span><span class="o">;</span> <span class="nx">self</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_parent</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">depth</span><span class="o">++;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">depth</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_totalDepth</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_totalDepth</span> <span class="o">=</span> <span class="nx">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
			<span class="p">}</span>
			<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">defs</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="o">,</span> <span class="k">this</span><span class="p">);</span>
		<span class="p">}</span><span class="o">,</span>

		<span class="c">/**</span>
<span class="c">		 * Adds a field definition at a given position, if provided</span>
<span class="c">		 * @method add</span>
<span class="c">		 * @param item {object or FieldDef} FieldDef to add or object literal to convert to a FieldDef and add</span>
<span class="c">		 * @param index {integer} Position to add this item at (at the end if missing)</span>
<span class="c">		 */</span>
		
		<span class="nx">add</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="o">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">setPrimaryKey</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">item</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">FieldDef</span><span class="p">))</span> <span class="p">{</span>
				<span class="nx">item</span><span class="p">.</span><span class="nx">_parent</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">primaryKey</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">delete</span> <span class="nx">item</span><span class="p">.</span><span class="nx">primaryKey</span><span class="o">;</span>
					<span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FieldDef</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
					<span class="nx">setPrimaryKey</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FieldDef</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">FieldDef</span><span class="p">))</span> <span class="p">{</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Failed to add field definition&#39;</span><span class="o">,</span><span class="nx">ERROR</span><span class="o">,</span><span class="nx">FIELD_DEF_SET</span><span class="p">);</span>
				<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
			<span class="p">}</span>
			<span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NAME</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Field definitions require a NAME attribute&quot;</span><span class="o">,</span> <span class="nx">ERROR</span><span class="o">,</span> <span class="nx">FIELD_DEF_SET</span><span class="p">);</span>
				<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
			<span class="p">}</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">_root</span><span class="p">.</span><span class="nx">_keys</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">item</span><span class="o">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">index</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">index</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">index</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="nx">name</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">setPrimaryKey</span><span class="p">)</span> <span class="p">{</span>
				<span class="c">// This to make sure event FieldDef:primaryKeyChange is fired</span>
				<span class="nx">item</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">PRIMARY_KEY</span><span class="o">,</span><span class="kc">true</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="k">this</span><span class="o">;</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Returns the total nesting level of the whole tree.</span>
<span class="c">		 * @method getDepth</span>
<span class="c">		 * @return {integer} Total depth of the whole tree</span>
<span class="c">		 */</span>
		<span class="nx">getDepth</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_root</span><span class="p">.</span><span class="nx">_totalDepth</span><span class="o">;</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Traverses the field definitions tree in several ways, calling the provided function for each field definition.</span>
<span class="c">		 * Traversing is done in the order in which the definitions were added, unless added with explicit indices.</span>
<span class="c">		 * @method traverse</span>
<span class="c">		 * @param method {string} Any of the following constants: &lt;ul&gt;</span>
<span class="c">		 * &lt;li&gt;&lt;code&gt;FieldDefSet.TRAVERSE_SHALLOW&lt;/code&gt; fieldDefs are traversed by level, useful for building HTML table headers&lt;/li&gt;</span>
<span class="c">		 * &lt;li&gt;&lt;code&gt;FieldDefSet.TRAVERSE_DEEP&lt;/code&gt; fieldDefs are traversed going deep into each branch before going to the next, </span>
<span class="c">		 * useful for building HTML forms with nested fieldSets.&lt;/li&gt;</span>
<span class="c">		 * &lt;li&gt;&lt;code&gt;FieldDefSet.TRAVERSE_LEAVES&lt;/code&gt; only fieldDefs which have no children, lists only the ones that store data&lt;/li&gt;</span>
<span class="c">		 * &lt;/ul&gt;</span>
<span class="c">		 * @param fn {function} Function to be called for each field definition.</span>
<span class="c">		 * It will receive: &lt;ul&gt;</span>
<span class="c">		 * &lt;li&gt;&lt;code&gt;fieldDef&lt;/code&gt; Definition for each field&lt;/li&gt;</span>
<span class="c">		 * &lt;li&gt;&lt;code&gt;depth&lt;/code&gt; Level of nesting of this definition&lt;/li&gt;</span>
<span class="c">		 * &lt;/ul&gt;</span>
<span class="c">		 * @param context {object} (optional) Context to execute the function in (defaults to this FieldDefSet instance)</span>
<span class="c">		 * @param _depth {integer} (private) Used to keep track of the depth in recursive calling.</span>
<span class="c">		 */</span>
		<span class="nx">traverse</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="o">,</span> <span class="nx">fn</span><span class="o">,</span> <span class="nx">context</span><span class="o">,</span> <span class="nx">_depth</span><span class="p">)</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">item</span><span class="o">,</span> <span class="nx">pending</span> <span class="o">=</span> <span class="p">[]</span><span class="o">,</span> <span class="nx">children</span><span class="o">,</span> <span class="nx">keys</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_root</span><span class="p">.</span><span class="nx">_keys</span><span class="o">;</span>
			<span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span> <span class="o">||</span> <span class="k">this</span><span class="o">;</span>
			<span class="nx">_depth</span> <span class="o">=</span> <span class="nx">_depth</span> <span class="o">||</span> <span class="mi">0</span><span class="o">;</span>
			<span class="nx">switch</span> <span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">case</span> <span class="nx">TRAVERSE_DEEP</span><span class="o">:</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">item</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
						<span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="o">,</span> <span class="nx">item</span><span class="o">,</span> <span class="nx">_depth</span><span class="p">);</span>
						<span class="nx">children</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">CHILDREN</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">children</span><span class="p">.</span><span class="nx">traverse</span><span class="p">(</span><span class="nx">method</span><span class="o">,</span> <span class="nx">fn</span><span class="o">,</span> <span class="nx">context</span><span class="o">,</span> <span class="nx">_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
						<span class="p">}</span>
					<span class="p">});</span>
					<span class="k">break</span><span class="o">;</span>
				<span class="nx">case</span> <span class="nx">TRAVERSE_SHALLOW</span><span class="o">:</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">item</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
						<span class="nx">children</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">CHILDREN</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">pending</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">children</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="o">,</span> <span class="nx">item</span><span class="o">,</span> <span class="nx">_depth</span><span class="p">);</span>
					<span class="p">});</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">pending</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">item</span><span class="p">.</span><span class="nx">traverse</span><span class="p">(</span><span class="nx">method</span><span class="o">,</span> <span class="nx">fn</span><span class="o">,</span> <span class="nx">context</span><span class="o">,</span> <span class="nx">_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
					<span class="p">});</span>
					<span class="k">break</span><span class="o">;</span>
				<span class="nx">case</span> <span class="nx">TRAVERSE_LEAVES</span><span class="o">:</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">item</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
						<span class="nx">children</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">CHILDREN</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">children</span><span class="p">.</span><span class="nx">traverse</span><span class="p">(</span><span class="nx">method</span><span class="o">,</span> <span class="nx">fn</span><span class="o">,</span> <span class="nx">context</span><span class="o">,</span> <span class="nx">_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">context</span><span class="o">,</span> <span class="nx">item</span><span class="o">,</span> <span class="nx">_depth</span><span class="p">);</span>
						<span class="p">}</span>
					<span class="p">});</span>
					<span class="k">break</span><span class="o">;</span>
				<span class="nx">default</span><span class="o">:</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Unknown traverse method: &#39;</span> <span class="o">+</span> <span class="nx">method</span><span class="o">,</span> <span class="nx">WARN</span><span class="o">,</span> <span class="nx">FIELD_DEF_SET</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Shortcut to traverse leaves, that is, definitions for fields containing data.</span>
<span class="c">		 * @method each</span>
<span class="c">		 * @param fn {function} Function to be called for each field definition.</span>
<span class="c">		 * It will receive: &lt;ul&gt;</span>
<span class="c">		 * &lt;li&gt;&lt;code&gt;fieldDef&lt;/code&gt; Definition for each field&lt;/li&gt;</span>
<span class="c">		 * &lt;li&gt;&lt;code&gt;depth&lt;/code&gt; Level of nesting of this definition&lt;/li&gt;</span>
<span class="c">		 * &lt;/ul&gt;</span>
<span class="c">		 * @param context {object} (optional) Context to execute the function in (defaults to this FieldDefSet instance)</span>
<span class="c">		 */</span>
		<span class="nx">each</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="o">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">traverse</span><span class="p">(</span><span class="nx">TRAVERSE_LEAVES</span><span class="o">,</span><span class="nx">fn</span><span class="o">,</span><span class="nx">context</span><span class="p">);</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Returns the FieldDef with the given name</span>
<span class="c">		 * @method item</span>
<span class="c">		 * @param name {string} Name of the field definition sought</span>
<span class="c">		 * @return {FieldDef} Definition for that field</span>
<span class="c">		 */</span>
		<span class="nx">item</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_root</span><span class="p">.</span><span class="nx">_keys</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Returns the number of definitions contained in this set at this level</span>
<span class="c">		 * @method size</span>
<span class="c">		 * @return {integer} number of definitions</span>
<span class="c">		 */</span>
		<span class="nx">size</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * True if this set has no definitions</span>
<span class="c">		 * @method isEmpty</span>
<span class="c">		 * @return {Boolean} </span>
<span class="c">		 */</span>
		<span class="nx">isEmpty</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
			<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="o">;</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Adds or create a field definition and sets the value for a particular key.</span>
<span class="c">		 * FieldDefs are sought by name at any depth in the definitions tree, but if it doesn&#39;t exist, </span>
<span class="c">		 * it will be created in this set.</span>
<span class="c">		 * @method set</span>
<span class="c">		 * @param name {string} name of the field whose definition is to be set</span>
<span class="c">		 * @param key {string} name of the definition to be set</span>
<span class="c">		 * @param value {any} value to be set</span>
<span class="c">		 */</span>
		
		<span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="o">,</span> <span class="nx">key</span><span class="o">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">def</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">def</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">def</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">key</span><span class="o">,</span><span class="nx">value</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">fd</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">};</span>
				<span class="nx">fd</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="o">;</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">fd</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Returns the value of a definition for a given field</span>
<span class="c">		 * @method get</span>
<span class="c">		 * @param name {string} Name of the field</span>
<span class="c">		 * @param key {string} Name of the definition</span>
<span class="c">		 * @return {any} value for that definition or Y.Attribute.INVALID_VALUE if no such field is found.</span>
<span class="c">		 */</span>
		<span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="o">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">def</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">def</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">return</span> <span class="nx">def</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Attribute</span><span class="p">.</span><span class="nx">INVALID_VALUE</span><span class="o">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		
	<span class="p">};</span>
	<span class="c">/**</span>
<span class="c">	 * Constant to indicate &lt;a href=&quot;#method_traverse&quot;&gt;traversal&lt;/a&gt; method</span>
<span class="c">	 * @property FieldDefSet.TRAVERSE_DEEP</span>
<span class="c">	 * @type string</span>
<span class="c">	 * @static</span>
<span class="c">	 */</span>
	<span class="nx">FieldDefSet</span><span class="p">.</span><span class="nx">TRAVERSE_DEEP</span> <span class="o">=</span> <span class="nx">TRAVERSE_DEEP</span><span class="o">;</span>
	<span class="c">/**</span>
<span class="c">	 * Constant to indicate &lt;a href=&quot;#method_traverse&quot;&gt;traversal&lt;/a&gt; method</span>
<span class="c">	 * @property FieldDefSet.TRAVERSE_SHALLOW</span>
<span class="c">	 * @type string</span>
<span class="c">	 * @static</span>
<span class="c">	 */</span>
	<span class="nx">FieldDefSet</span><span class="p">.</span><span class="nx">TRAVERSE_SHALLOW</span> <span class="o">=</span> <span class="nx">TRAVERSE_SHALLOW</span><span class="o">;</span>
	<span class="c">/**</span>
<span class="c">	 * Constant to indicate &lt;a href=&quot;#method_traverse&quot;&gt;traversal&lt;/a&gt; method</span>
<span class="c">	 * @property FieldDefSet.TRAVERSE_LEAVES</span>
<span class="c">	 * @type string</span>
<span class="c">	 * @static</span>
<span class="c">	 */</span>
	<span class="nx">FieldDefSet</span><span class="p">.</span><span class="nx">TRAVERSE_LEAVES</span> <span class="o">=</span> <span class="nx">TRAVERSE_LEAVES</span><span class="o">;</span>
	<span class="nx">Y</span><span class="p">.</span><span class="nx">augment</span><span class="p">(</span><span class="nx">FieldDefSet</span><span class="o">,</span><span class="nx">Y</span><span class="p">.</span><span class="nx">EventTarget</span><span class="p">);</span>
	<span class="nx">Y</span><span class="p">[</span><span class="nx">FIELD_DEF_SET</span><span class="p">]</span> <span class="o">=</span> <span class="nx">FieldDefSet</span><span class="o">;</span>

		
	<span class="c">/**</span>
<span class="c">	 * The Record class provides storage for a single row of data. </span>
<span class="c">	 * @class Record</span>
<span class="c">	 * @extends Base</span>
<span class="c">	 * @constructor</span>
<span class="c">	 * @param cfg {object} Configuration Attributes</span>
<span class="c">	 */</span>
	
	<span class="kd">var</span> <span class="nx">Record</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
		<span class="nx">RECORD</span><span class="o">,</span>
		<span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="o">,</span>
		<span class="p">[]</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Array of &lt;a href=&quot;Record.Field.html&quot;&gt;&lt;code&gt;Record.Field&lt;/code&gt;&lt;/a&gt; objects</span>
<span class="c">			 * @property _fields</span>
<span class="c">			 * @type [Record.Field]</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_fields</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Adds a new &lt;a href=&quot;Record.Field.html&quot;&gt;&lt;code&gt;Record.Field&lt;/code&gt;&lt;/a&gt; to the Record</span>
<span class="c">			 * @method addField</span>
<span class="c">			 * @param fieldName {string} Name of the field</span>
<span class="c">			 * @param value {any} initial value</span>
<span class="c">			 * @return Instance of &lt;a href=&quot;Record.Field.html&quot;&gt;&lt;code&gt;Record.Field&lt;/code&gt;&lt;/a&gt; just added</span>
<span class="c">			 */</span>
			<span class="nx">addField</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Record</span><span class="p">.</span><span class="nx">Field</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="nx">fieldName</span><span class="o">,</span><span class="nx">value</span><span class="o">:</span><span class="nx">value</span><span class="p">}));</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Returns the instance of &lt;a href=&quot;Record.Field.html&quot;&gt;&lt;code&gt;Record.Field&lt;/code&gt;&lt;/a&gt; for the field</span>
<span class="c">			 * @method getField</span>
<span class="c">			 * @param fieldName {string} Name of the field</span>
<span class="c">			 * @return {Record.Field} field definition</span>
<span class="c">			 */</span>
			<span class="nx">getField</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">];</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Returns the value of a field or an object with all the field values</span>
<span class="c">			 * @method getValue</span>
<span class="c">			 * @param fieldName {string} Optional: if provided it will return the value of that field, </span>
<span class="c">			 *        otherwise it will return an object literal with all values</span>
<span class="c">			 * @return {any} The value of the field requested, an object with all values or null if the Record is marked as deleted</span>
<span class="c">			 */</span>
			<span class="nx">getValue</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">DELETED</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">return</span> <span class="p">(</span><span class="nx">fieldName</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="o">?</span><span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">].</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">)</span><span class="o">||</span><span class="kc">null</span><span class="o">:</span><span class="kc">null</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="kd">var</span> <span class="nx">oData</span> <span class="o">=</span> <span class="p">{};</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">field</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">oData</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">);</span>
					<span class="p">});</span>
					<span class="k">return</span> <span class="nx">oData</span><span class="o">;</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Sets the value for a specific field.  If field does not exist, it creates it.</span>
<span class="c">			 * @method setValue</span>
<span class="c">			 * @param fieldName {string} Name of the field</span>
<span class="c">			 * @param value {any} value to be set</span>
<span class="c">			 */</span>
			<span class="nx">setValue</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">fieldName</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">addField</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="kd">var</span> <span class="nx">field</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">];</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">)</span> <span class="o">!==</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">OLD_VALUE</span><span class="o">,</span><span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">));</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">VALUE</span><span class="o">,</span><span class="nx">value</span><span class="p">);</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">DIRTY</span><span class="o">,</span><span class="kc">true</span><span class="p">);</span>
				<span class="p">}</span>
				
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Loops through each of the fields</span>
<span class="c">			 * @method each</span>
<span class="c">			 * @param fn {function} Function to be executed on each field.  It will receive the Field object and the field name</span>
<span class="c">			 * @param context {object} Context to execute the function in</span>
<span class="c">			 * @return The YUI instance</span>
<span class="c">			 */</span>
			<span class="nx">each</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="o">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="o">,</span> <span class="nx">fn</span><span class="o">,</span> <span class="nx">context</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Restores the previous value of a field or of a whole record.  There is only one level of undo.</span>
<span class="c">			 * @method undo</span>
<span class="c">			 * @param fieldName {string} (optional) If provided, it will undo the named field, otherwise, it undoes the whole record</span>
<span class="c">			 */</span>
			<span class="nx">undo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">undoField</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">VALUE</span><span class="o">,</span><span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">OLD_VALUE</span><span class="p">));</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">DIRTY</span><span class="o">,</span> <span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">)</span> <span class="o">!==</span> <span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">INITIAL_VALUE</span><span class="p">));</span>
				<span class="p">};</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">))</span> <span class="p">{</span>
					<span class="nx">undoField</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">undoField</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Restores the initial value of a field or of a whole record</span>
<span class="c">			 * @method reset</span>
<span class="c">			 * @param fieldName {string} (optional) If provided, it will reset the named field, otherwise, it resets the whole record</span>
<span class="c">			 */</span>
			<span class="nx">reset</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">resetField</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">VALUE</span><span class="o">,</span><span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">INITIAL_VALUE</span><span class="p">));</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">DIRTY</span><span class="o">,</span><span class="kc">false</span><span class="p">);</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">OLD_VALUE</span><span class="o">,</span><span class="kc">undefined</span><span class="p">);</span>
				<span class="p">};</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">))</span> <span class="p">{</span>
					<span class="nx">resetField</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">resetField</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Accepts the current value of a field or of whole record as good.  </span>
<span class="c">			 * Used when the Record has been synchronized with the original source </span>
<span class="c">			 * (usually a database table in the server) </span>
<span class="c">			 * to signal that the current value has been accepted as good by the server.</span>
<span class="c">			 * @method accept</span>
<span class="c">			 * @param fieldName {string} (optional) If provided, it will accept the named field, otherwise, it accepts the whole record</span>
<span class="c">			 */</span>

			<span class="nx">accept</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">acceptField</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">INITIAL_VALUE</span><span class="o">,</span> <span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">));</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">OLD_VALUE</span><span class="o">,</span> <span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">));</span>
					<span class="nx">field</span><span class="p">.</span><span class="nx">setAttrs</span><span class="p">({</span>
						<span class="nx">dirty</span><span class="o">:</span><span class="kc">false</span><span class="o">,</span>
						<span class="s1">&#39;new&#39;</span><span class="o">:</span><span class="kc">false</span>
					<span class="p">});</span>
				<span class="p">};</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">))</span> <span class="p">{</span>
					<span class="nx">acceptField</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">acceptField</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Initializer inherited from Y.Base and overridden</span>
<span class="c">			 * @method initializer</span>
<span class="c">			 * @param cfg {object} Initial configuration</span>
<span class="c">			 * If the configuration object has a &lt;code&gt;data&lt;/code&gt; property containing an oject literal, </span>
<span class="c">			 * it will load the Record with those values</span>
<span class="c">			 */</span>
				
			<span class="nx">initializer</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">stamp</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
				<span class="nx">cfg</span> <span class="o">=</span> <span class="nx">cfg</span> <span class="o">||</span> <span class="p">{};</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_fields</span> <span class="o">=</span> <span class="p">{};</span>
				<span class="k">if</span> <span class="p">(</span><span class="s1">&#39;data&#39;</span> <span class="k">in</span> <span class="nx">cfg</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">cfg</span><span class="p">.</span><span class="nx">data</span><span class="o">,</span><span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">addField</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span><span class="nx">value</span><span class="p">);</span>
					<span class="p">}</span><span class="o">,</span> <span class="k">this</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;Field:newChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onNewChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;Field:dirtyChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onDirtyChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>		
			<span class="nx">_onDirtyChange</span><span class="o">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="o">,</span> <span class="nx">d</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="nx">mine</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">mine</span> <span class="o">=</span> <span class="nx">mine</span> <span class="o">||</span> <span class="nx">field</span> <span class="o">==</span> <span class="nx">target</span><span class="o">;</span>
					<span class="nx">d</span> <span class="o">=</span> <span class="nx">d</span> <span class="o">||</span> <span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">DIRTY</span><span class="p">);</span>
				<span class="p">});</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">mine</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">_set</span><span class="p">(</span><span class="nx">DIRTY</span><span class="o">,</span><span class="nx">d</span><span class="o">,</span><span class="p">{</span><span class="nx">fieldName</span><span class="o">:</span><span class="nx">target</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NAME</span><span class="p">)});</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="nx">_onNewChange</span><span class="o">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="o">,</span> <span class="nx">n</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">mine</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
				
				<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">mine</span> <span class="o">=</span> <span class="nx">mine</span> <span class="o">||</span> <span class="nx">field</span> <span class="o">==</span> <span class="nx">target</span><span class="o">;</span>
					<span class="nx">n</span> <span class="o">=</span> <span class="nx">n</span> <span class="o">&amp;&amp;</span> <span class="nx">field</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NEW</span><span class="p">);</span>
				<span class="p">});</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">mine</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">_set</span><span class="p">(</span><span class="nx">NEW</span><span class="o">,</span><span class="nx">n</span><span class="o">,</span><span class="p">{</span><span class="nx">fieldName</span><span class="o">:</span><span class="nx">target</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NAME</span><span class="p">)});</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="nx">destructor</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;Field:newChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onNewChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;Field:dirtyChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onDirtyChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">f</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
				<span class="p">});</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="nx">ATTRS</span><span class="o">:</span> <span class="p">{</span>
				<span class="c">/**</span>
<span class="c">				 * True when any of the fields is dirty. Read only.</span>
<span class="c">				 * @attribute dirty</span>
<span class="c">				 * @type Boolean</span>
<span class="c">				 * @readOnly</span>
<span class="c">				 */</span>
				<span class="nx">dirty</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">readOnly</span><span class="o">:</span><span class="kc">true</span><span class="o">,</span>
					<span class="nx">value</span><span class="o">:</span><span class="kc">false</span><span class="o">,</span>
					<span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">DELETED</span><span class="p">)</span> <span class="o">||</span> <span class="nx">value</span><span class="o">;</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * True when all the fields are new. Read Only</span>
<span class="c">				 * @attribute new</span>
<span class="c">				 * @type Boolean</span>
<span class="c">				 * @readOnly</span>
<span class="c">				 */</span>
				<span class="s1">&#39;new&#39;</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="kc">true</span><span class="o">,</span>
					<span class="nx">readOnly</span><span class="o">:</span><span class="kc">true</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Marks the record as deleted</span>
<span class="c">				 * @attribute deleted</span>
<span class="c">				 * @type Boolean</span>
<span class="c">				 */</span>
				<span class="nx">deleted</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="kc">false</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * The Record.Field class stores a single piece of data, keeping track of its modified (dirty) or newly created(new)</span>
<span class="c">			 * current, previous and initial values.</span>
<span class="c">			 * @class Record.Field</span>
<span class="c">			 * @constructor</span>
<span class="c">			 * @extends Base</span>
<span class="c">			 * @param value {mixed} initial value for this field</span>
<span class="c">			 */</span>
			<span class="nx">Field</span><span class="o">:</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
				<span class="nx">FIELD</span><span class="o">,</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="o">,</span>
				<span class="p">[]</span><span class="o">,</span>
				<span class="p">{</span>
					<span class="c">/**</span>
<span class="c">					 * Ensures the initialValue is set</span>
<span class="c">					 * @method initializer</span>
<span class="c">					 * @param cfg {object} initial configuration</span>
<span class="c">					 */</span>
					<span class="nx">initializer</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">VALUE</span> <span class="k">in</span> <span class="nx">cfg</span><span class="p">)</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">INITIAL_VALUE</span> <span class="k">in</span> <span class="nx">cfg</span><span class="p">))</span> <span class="p">{</span>
								<span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">INITIAL_VALUE</span><span class="o">,</span><span class="nx">cfg</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
							<span class="p">}</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="p">{</span>
					<span class="nx">ATTRS</span><span class="o">:</span> <span class="p">{</span>
						<span class="c">/**</span>
<span class="c">						 * Stores the name for this field</span>
<span class="c">						 * @attribute name</span>
<span class="c">						 * @type string</span>
<span class="c">						 */</span>
						<span class="nx">name</span><span class="o">:</span> <span class="p">{</span>
							<span class="nx">validator</span><span class="o">:</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
						<span class="p">}</span><span class="o">,</span>
						<span class="c">/**</span>
<span class="c">						 * Stores the value for this field</span>
<span class="c">						 * @attribute value</span>
<span class="c">						 * @type any</span>
<span class="c">						 */</span>
						<span class="nx">value</span><span class="o">:</span><span class="p">{</span>
						<span class="p">}</span><span class="o">,</span>
						<span class="c">/**</span>
<span class="c">						 * Stores the initial value of the field</span>
<span class="c">						 * @attribute initialValue</span>
<span class="c">						 * @type any</span>
<span class="c">						 */</span>
						<span class="nx">initialValue</span><span class="o">:</span> <span class="p">{</span>
						<span class="p">}</span><span class="o">,</span>
						<span class="c">/**</span>
<span class="c">						 * Stores the most recent previous value. Used for undoing</span>
<span class="c">						 * @attribute oldValue</span>
<span class="c">						 * @type any</span>
<span class="c">						 */</span>
						<span class="nx">oldValue</span><span class="o">:</span><span class="p">{</span>
						<span class="p">}</span><span class="o">,</span>
						<span class="c">/**</span>
<span class="c">						 * Signals if the field has been newly created instead of loaded from a remote source</span>
<span class="c">						 * @attribute new</span>
<span class="c">						 * @type Boolean</span>
<span class="c">						 */</span>
						<span class="s1">&#39;new&#39;</span><span class="o">:</span> <span class="p">{</span>
							<span class="nx">value</span><span class="o">:</span><span class="kc">true</span><span class="o">,</span>
							<span class="nx">validator</span><span class="o">:</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="o">,</span>
							<span class="nx">broadcast</span><span class="o">:</span><span class="mi">1</span><span class="o">,</span>
							<span class="nx">lazyAdd</span><span class="o">:</span> <span class="kc">false</span>
						<span class="p">}</span><span class="o">,</span>
						<span class="c">/**</span>
<span class="c">						 * Signals if the value was modified since last created or accepted as good</span>
<span class="c">						 * @attribute dirty</span>
<span class="c">						 * @type Boolean</span>
<span class="c">						 */</span>
						<span class="nx">dirty</span><span class="o">:</span> <span class="p">{</span>
							<span class="nx">value</span><span class="o">:</span><span class="kc">false</span><span class="o">,</span>
							<span class="nx">validator</span><span class="o">:</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span><span class="o">,</span>
							<span class="nx">broadcast</span><span class="o">:</span><span class="mi">2</span><span class="o">,</span>
							<span class="nx">lazyAdd</span><span class="o">:</span> <span class="kc">false</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">)</span>
			
		<span class="p">}</span>
	<span class="p">);</span>
	<span class="nx">Y</span><span class="p">[</span><span class="nx">RECORD</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Record</span><span class="o">;</span>
	
	

	<span class="c">/**</span>
<span class="c">	 * Represents a collection of Records</span>
<span class="c">	 * @class RecordSet</span>
<span class="c">	 * @extends Base</span>
<span class="c">	 * @uses ArrayList</span>
<span class="c">	 * @constructor</span>
<span class="c">	 * @param cfg {object} Configuration attributes</span>
<span class="c">	 */</span>
	<span class="kd">var</span> <span class="nx">RecordSet</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
		<span class="nx">RECORDSET</span><span class="o">,</span>
		<span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="o">,</span>
		<span class="p">[]</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Array storing the Records (ArrayList expects it to have this name)</span>
<span class="c">			 * @property _items</span>
<span class="c">			 * @type [Record]</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_items</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Hash storing the field definitions, indexed by the name of the field</span>
<span class="c">			 * @property _defs</span>
<span class="c">			 * @type {object}</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_defs</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Index of records indexed by all fields marked as &lt;a  href=&quot;RecordSet.FieldDef.html#config_primaryKey&quot;&gt;&lt;code&gt;primaryKey&lt;/code&gt;&lt;/a&gt;.</span>
<span class="c">			 * @property _index</span>
<span class="c">			 * @type {object}</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_index</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
			
			<span class="c">/**</span>
<span class="c">			 * Loads data from DataSource.  Default function for event &lt;a href=&quot;#event_loadData&quot;&gt;&lt;code&gt;loadData&lt;/code&gt;&lt;/a&gt;.</span>
<span class="c">			 * @method _defLoadData</span>
<span class="c">			 * @param ev {event} Event object created by &lt;code&gt;loadData&lt;/code&gt;</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_defLoadData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">parser</span><span class="o">,</span> <span class="nx">type</span><span class="o">,</span>  <span class="nx">parsers</span> <span class="o">=</span> <span class="p">{};</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">eachDef</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">parser</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;server.parser&#39;</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">parser</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">type</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span><span class="p">[</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)];</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">parser</span> <span class="o">=</span> <span class="nx">type</span><span class="p">.</span><span class="nx">server</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">parser</span><span class="o">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="nx">parsers</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parser</span><span class="o">;</span>
				<span class="p">});</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">results</span><span class="o">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
					<span class="kd">var</span> <span class="nx">newRow</span> <span class="o">=</span> <span class="p">{};</span>
						
					<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">row</span><span class="o">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">parsers</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">])</span> <span class="p">{</span>
							<span class="nx">newRow</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parsers</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">](</span><span class="nx">value</span><span class="p">);</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="nx">newRow</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="o">;</span>
						<span class="p">}</span>
					<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">Record</span><span class="p">({</span><span class="nx">data</span><span class="o">:</span><span class="nx">newRow</span><span class="p">}));</span>
				<span class="p">}</span><span class="o">,</span> <span class="k">this</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Initializer inherited from Y.Base and overridden</span>
<span class="c">			 * @method initializer</span>
<span class="c">			 * @param cfg {object} Initial configuration (not used)</span>
<span class="c">			 */</span>
			<span class="nx">initializer</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_items</span> <span class="o">=</span> <span class="p">[];</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_index</span> <span class="o">=</span> <span class="p">{};</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">stamp</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

				<span class="nx">Y</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;FieldDef:primaryKeyChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_reIndex</span> <span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">RecordSet</span><span class="p">.</span><span class="nx">Serializers</span><span class="o">,</span> <span class="p">{</span>
					<span class="nx">JSON</span><span class="o">:</span><span class="nx">Y</span><span class="p">.</span><span class="nx">JSON</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="o">,</span>
					<span class="nx">XML</span><span class="o">:</span><span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">XML</span><span class="p">.</span><span class="nx">format</span><span class="o">,</span>
					<span class="nx">URL</span><span class="o">:</span><span class="nx">RecordSet</span><span class="p">.</span><span class="nx">serializeURL</span>
				<span class="p">}</span><span class="o">,</span><span class="kc">true</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Destructor</span>
<span class="c">			 * @method destructor</span>
<span class="c">			 */</span>
			<span class="nx">destructor</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;FieldDef:primaryKeyChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_reIndex</span> <span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">r</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
				<span class="p">});</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Adds a Record to the collection.</span>
<span class="c">			 * Overrides ArrayList.add checking that record is an instance of Record and adding indexes if required.</span>
<span class="c">			 * @method add</span>
<span class="c">			 * @param record {Record} Record to be added</span>
<span class="c">			 * @param index {integer} (optional) position to insert it in, otherwise, at the end.</span>
<span class="c">			 * @return {Record} Record just added</span>
<span class="c">			 */</span>
			<span class="nx">add</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">record</span><span class="o">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">record</span> <span class="k">instanceof</span> <span class="nx">Record</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">record</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">setFieldDef</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span><span class="p">{});</span>
					<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
					<span class="kd">var</span> <span class="nx">value</span><span class="o">,</span> <span class="nx">branch</span><span class="o">,</span> <span class="nx">initialValue</span><span class="o">;</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">eachDef</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">def</span><span class="o">,</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">def</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">PRIMARY_KEY</span><span class="p">))</span> <span class="p">{</span>
							<span class="nx">branch</span> <span class="o">=</span> <span class="p">(</span><span class="nx">branch</span><span class="o">?</span><span class="nx">branch</span><span class="p">[</span><span class="nx">value</span><span class="p">]</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_index</span><span class="p">);</span>  <span class="c">// yes, I am looking for the branch for the previous value</span>
							<span class="nx">value</span> <span class="o">=</span> <span class="nx">record</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">);</span>           <span class="c">// now I get the new fieldName value</span>
							<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">value</span> <span class="k">in</span> <span class="nx">branch</span><span class="p">))</span> <span class="p">{</span>
								<span class="nx">branch</span><span class="p">[</span><span class="nx">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
							<span class="p">}</span>
						<span class="p">}</span>
						<span class="nx">initialValue</span> <span class="o">=</span> <span class="nx">def</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">INITIAL_VALUE</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isNull</span><span class="p">(</span><span class="nx">initialValue</span><span class="p">)</span> <span class="o">||</span> <span class="nx">record</span><span class="p">.</span><span class="nx">getField</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">)))</span> <span class="p">{</span>
							<span class="nx">record</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span> <span class="nx">initialValue</span><span class="p">);</span>
						<span class="p">}</span>
							
					<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">branch</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">branch</span><span class="p">[</span><span class="nx">value</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nx">Record</span><span class="p">)</span> <span class="p">{</span>
							<span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">branch</span><span class="p">[</span><span class="nx">value</span><span class="p">].</span><span class="nx">_yuid</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="o">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
								<span class="k">return</span> <span class="nx">a</span> <span class="o">===</span> <span class="nx">b</span><span class="p">.</span><span class="nx">_yuid</span><span class="o">;</span>
							<span class="p">});</span>
						<span class="p">}</span>
						<span class="nx">branch</span><span class="p">[</span><span class="nx">value</span><span class="p">]</span> <span class="o">=</span> <span class="nx">record</span><span class="o">;</span>
					<span class="p">}</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">ArrayList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">add</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="o">,</span><span class="nx">arguments</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">return</span> <span class="nx">record</span><span class="o">;</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Searches the RecordSet by primaryKey values</span>
<span class="c">			 * @method search</span>
<span class="c">			 * @param needles {value or object} key values of item to be located. </span>
<span class="c">			 *        For RecordSets with a single primaryKey field, needles can be a string containing the value of the key sought.</span>
<span class="c">			 *        For all, needles is an object containing fieldName: value sets of the key values sought</span>
<span class="c">			 * @return {Record} Record sought or null</span>
<span class="c">			 * !Warning:  For values containing objects, such as Date, use an object literal as search argument, not the plain value</span>
<span class="c">			 */</span>
			<span class="nx">search</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">needles</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">needles</span><span class="p">))</span> <span class="p">{</span>
					<span class="kd">var</span> <span class="nx">value</span><span class="o">,</span> <span class="nx">branch</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_index</span><span class="o">;</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">eachDef</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">def</span><span class="o">,</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">def</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">PRIMARY_KEY</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">fieldName</span> <span class="k">in</span> <span class="nx">needles</span><span class="p">))</span> <span class="p">{</span>
								<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
							<span class="p">}</span>
							<span class="nx">branch</span> <span class="o">=</span> <span class="nx">branch</span><span class="p">[</span><span class="nx">needles</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]];</span>
							<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">branch</span><span class="p">)</span> <span class="p">{</span>
								<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
							<span class="p">}</span>
						<span class="p">}</span>
					<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
					<span class="k">return</span> <span class="nx">branch</span> <span class="o">||</span> <span class="kc">null</span><span class="o">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_index</span><span class="p">[</span><span class="nx">needles</span><span class="p">]</span> <span class="o">||</span> <span class="kc">null</span><span class="o">;</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Rebuilds the index whenever the &lt;a  href=&quot;RecordSet.FieldDef.html#config_primaryKey&quot;&gt;&lt;code&gt;primaryKey&lt;/code&gt;&lt;/a&gt; setting of a field is changed</span>
<span class="c">			 * @method _reIndex</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_reIndex</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">fieldNames</span> <span class="o">=</span> <span class="p">[]</span><span class="o">,</span> <span class="nx">value</span><span class="o">,</span> <span class="nx">branch</span><span class="o">;</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">eachDef</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">def</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">def</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">PRIMARY_KEY</span><span class="p">))</span> <span class="p">{</span>
						<span class="nx">fieldNames</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">});</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_index</span> <span class="o">=</span> <span class="p">{};</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">fieldNames</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">branch</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
						<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">fieldNames</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">branch</span> <span class="o">=</span> <span class="p">(</span><span class="nx">branch</span><span class="o">?</span><span class="nx">branch</span><span class="p">[</span><span class="nx">value</span><span class="p">]</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_index</span><span class="p">);</span>  <span class="c">// yes, I am looking for the branch for the previous value</span>
							<span class="nx">value</span> <span class="o">=</span> <span class="nx">record</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">);</span>                 <span class="c">// now I get the new fieldName value</span>
							<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">value</span> <span class="k">in</span> <span class="nx">branch</span><span class="p">))</span> <span class="p">{</span>
								<span class="nx">branch</span><span class="p">[</span><span class="nx">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
							<span class="p">}</span>
						<span class="p">}</span><span class="o">,</span> <span class="k">this</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">branch</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">branch</span><span class="p">[</span><span class="nx">value</span><span class="p">]</span> <span class="o">=</span> <span class="nx">record</span><span class="o">;</span>
						<span class="p">}</span>				
					<span class="p">}</span><span class="o">,</span> <span class="k">this</span><span class="p">);</span>
				<span class="p">}</span>

			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Sorts by the given field in ascending order unless the second argument says otherwise.</span>
<span class="c">			 * If either exists, it will use the comparison function set in the </span>
<span class="c">			 * sortCompareFunction for the &lt;a  href=&quot;RecordSet.FieldDef.html#config_sortCompareFunction&quot;&gt;&lt;code&gt;field&lt;/code&gt;&lt;/a&gt; </span>
<span class="c">			 * or the &lt;a  href=&quot;#config_sortCompareFunction&quot;&gt;&lt;code&gt;whole RecordSet&lt;/code&gt;&lt;/a&gt;, in that order.</span>
<span class="c">			 * @method sort</span>
<span class="c">			 * @param fieldName {string} Name of fields to sort the RecordSet by</span>
<span class="c">			 * @param desc {Boolean} sort descending</span>
<span class="c">			 */</span>
			<span class="nx">sort</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span> <span class="nx">desc</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;sort&#39;</span><span class="o">,</span><span class="p">{</span><span class="nx">defaultFn</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_defSortFn</span><span class="p">});</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;sort&#39;</span><span class="o">,</span><span class="p">{</span>
					<span class="nx">fieldName</span><span class="o">:</span><span class="nx">fieldName</span><span class="o">,</span>
					<span class="nx">desc</span><span class="o">:</span> <span class="nx">desc</span> <span class="o">||</span> <span class="kc">false</span>
				<span class="p">});</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Compares a couple of values returning integers to be used in sorting functions</span>
<span class="c">			 * @method _valueCompare</span>
<span class="c">			 * @param a {any} first value to compare</span>
<span class="c">			 * @param b {any} second value to compare</span>
<span class="c">			 * @param desc {Boolean} true if comparing in descending order</span>
<span class="c">			 * @return {0, 1 or -1} depending on compare and order</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="c">// This taken from YAHOO.util.Sort in datatable.js:</span>
			<span class="nx">_valueCompare</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="o">,</span> <span class="nx">b</span><span class="o">,</span> <span class="nx">desc</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span><span class="p">((</span><span class="nx">a</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">if</span><span class="p">((</span><span class="nx">b</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span> <span class="o">==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">))</span> <span class="p">{</span>
						<span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
					<span class="p">}</span>
					<span class="k">else</span> <span class="p">{</span>
						<span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="nx">b</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">b</span> <span class="o">==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
				<span class="p">}</span>

				<span class="k">if</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">==</span> <span class="nb">String</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
				<span class="p">}</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">==</span> <span class="nb">String</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">b</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
				<span class="p">}</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">a</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span> <span class="p">(</span><span class="nx">desc</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
				<span class="p">}</span>
				<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span> <span class="p">(</span><span class="nx">desc</span><span class="p">)</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="o">;</span>
				<span class="p">}</span>
				<span class="k">else</span> <span class="p">{</span>
					<span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Default Record compare function for sort</span>
<span class="c">			 * @method _fieldCompare</span>
<span class="c">			 * @param a {Record} first record to compare</span>
<span class="c">			 * @param b {Record} second record to compare</span>
<span class="c">			 * @param desc {Boolean} true if comparing in descending order</span>
<span class="c">			 * @param fieldName {string} name of the field to sort on</span>
<span class="c">			 * @return {0, 1 or -1} result suitable for Array.sort()</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_fieldCompare</span><span class="o">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="o">,</span> <span class="nx">b</span><span class="o">,</span> <span class="nx">desc</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">sorted</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_valueCompare</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span><span class="o">,</span><span class="nx">b</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span><span class="o">,</span> <span class="nx">desc</span><span class="p">);</span>
				<span class="k">if</span><span class="p">(</span><span class="nx">sorted</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_valueCompare</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">stamp</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">,</span><span class="nx">Y</span><span class="p">.</span><span class="nx">stamp</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span><span class="o">,</span> <span class="nx">desc</span><span class="p">);</span> 
				<span class="p">}</span>
				<span class="k">else</span> <span class="p">{</span>
					<span class="k">return</span> <span class="nx">sorted</span><span class="o">;</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Default sort function for sort event.</span>
<span class="c">			 * @method _defSortFn</span>
<span class="c">			 * @param ev {event} event object</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_defSortFn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">fieldName</span> <span class="o">=</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">fieldName</span><span class="o">,</span> <span class="nx">desc</span> <span class="o">=</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">desc</span><span class="o">,</span>
					<span class="nx">sortedBy</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">SORTED_BY</span><span class="p">)</span><span class="o">,</span>
					<span class="nx">sortComp</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFieldDef</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span><span class="nx">SORT_COMPARE</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">SORT_COMPARE</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fieldCompare</span><span class="o">,</span>
					<span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">sortedBy</span> <span class="o">&amp;&amp;</span> <span class="nx">sortedBy</span><span class="p">.</span><span class="nx">fieldName</span> <span class="o">==</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">sortedBy</span><span class="p">.</span><span class="nx">desc</span> <span class="o">!=</span> <span class="nx">desc</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">reverse</span><span class="p">();</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">sortComp</span><span class="p">))</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="o">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
							<span class="k">return</span> <span class="nx">sortComp</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="o">,</span><span class="nx">a</span><span class="o">,</span><span class="nx">b</span><span class="o">,</span><span class="nx">desc</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">);</span>
						<span class="p">});</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_items</span><span class="p">.</span><span class="nx">sort</span><span class="p">();</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">SORTED_BY</span><span class="o">,</span><span class="p">{</span>
					<span class="nx">fieldName</span><span class="o">:</span> <span class="nx">fieldName</span><span class="o">,</span>
					<span class="nx">desc</span><span class="o">:</span> <span class="nx">desc</span> <span class="o">||</span> <span class="kc">false</span>
				<span class="p">});</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="nx">_createFieldDef</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">fds</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FieldDefSet</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_defs</span> <span class="o">=</span> <span class="nx">fds</span><span class="o">;</span>
				<span class="k">return</span> <span class="nx">fds</span><span class="o">;</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Sets or adds definitions for a field</span>
<span class="c">			 * @method setFieldDef</span>
<span class="c">			 * @param fieldName {string} Name of the field to add the definition to</span>
<span class="c">			 * @param key {string or object} Depending on the type, it may:&lt;ul&gt;</span>
<span class="c">			 * &lt;li&gt;&lt;i&gt;string&lt;/i&gt; Name of &lt;a href=&quot;FieldDef.html&quot;&gt;&lt;code&gt;FieldDef&lt;/code&gt;&lt;/a&gt; attribute to set (requires third argument)&lt;/li&gt;</span>
<span class="c">			 * &lt;li&gt;&lt;i&gt;object&lt;/i&gt; Object literal with names and values of attributes to set&lt;/li&gt;</span>
<span class="c">			 * &lt;/ul&gt;</span>
<span class="c">			 * @param value {any} If &lt;code&gt;key&lt;/code&gt; is a string, value to be set. Ignored otherwise.</span>
<span class="c">			 * @return {object} new field definition</span>
<span class="c">			 */</span>
			<span class="nx">setFieldDef</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span> <span class="nx">key</span><span class="o">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
				
				<span class="kd">var</span> <span class="nx">fds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defs</span><span class="o">,</span> <span class="nx">fd</span><span class="o">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">fds</span> <span class="k">instanceof</span> <span class="nx">FieldDefSet</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
						<span class="nx">fds</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span><span class="nx">key</span><span class="o">,</span><span class="nx">value</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
						<span class="nx">key</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">fieldName</span><span class="o">;</span>
						<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">key</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="o">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">fds</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span><span class="nx">key</span><span class="o">,</span><span class="nx">value</span><span class="p">);</span>
						<span class="p">});</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
						<span class="nx">key</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">fieldName</span><span class="o">;</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_createFieldDef</span><span class="p">([</span><span class="nx">key</span><span class="p">]);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
						<span class="nx">fd</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span><span class="nx">fieldName</span><span class="p">};</span>
						<span class="nx">fd</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="o">;</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_createFieldDef</span><span class="p">([</span><span class="nx">fd</span><span class="p">]);</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Sets or adds a set of field definitions.  </span>
<span class="c">			 * Takes an object literal with names and FieldDef instances or configuration properties and calls &lt;a href=&quot;#method_setFieldDef&quot;&gt;&lt;code&gt;setFieldDef&lt;/code&gt;&lt;/a&gt; for each</span>
<span class="c">			 * @method setFieldDefs</span>
<span class="c">			 * @param cfg {object} Object containing definitions to set. It will use the properties as the names of the fields to set</span>
<span class="c">			 */</span>
			<span class="nx">setFieldDefs</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">fds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defs</span><span class="o">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fds</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">_createFieldDef</span><span class="p">();</span>
				<span class="p">}</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">cfg</span><span class="o">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">setFieldDef</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span><span class="nx">fieldDef</span><span class="p">);</span>
				<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Returns the value of a given attribute for a field  or the whole &lt;a href=&quot;RecordSet.FieldDef.html&quot;&gt;&lt;code&gt;RecordSet.FieldDef&lt;/code&gt;&lt;/a&gt;</span>
<span class="c">			 * @method getFieldDef</span>
<span class="c">			 * @param fieldName {string} Name of the field</span>
<span class="c">			 * @param key {string} (optional) Name of the attribute to look for</span>
<span class="c">			 * @return if &lt;code&gt;key&lt;/code&gt; is provided, the value of the attribute, otherwise, the whole &lt;a href=&quot;RecordSet.FieldDef.html&quot;&gt;&lt;code&gt;RecordSet.FieldDef&lt;/code&gt;&lt;/a&gt; instance of the filed</span>
<span class="c">			 */</span>
			<span class="nx">getFieldDef</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_defs</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">fieldName</span><span class="o">,</span><span class="nx">key</span><span class="p">);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Attribute</span><span class="p">.</span><span class="nx">INVALID_VALUE</span><span class="o">;</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Loops though each of the field definitions and calls the given function providing it with the instance</span>
<span class="c">			 * of &lt;a href=&quot;RecordSet.FieldDef.html&quot;&gt;&lt;code&gt;RecordSet.FieldDef&lt;/code&gt;&lt;/a&gt; for a field and the field key</span>
<span class="c">			 * @method eachDef</span>
<span class="c">			 * @param fn {function} A function to be called for each field definition.</span>
<span class="c">			 *        It will receive:&lt;ul&gt;</span>
<span class="c">			 *        &lt;li&gt;def {RecordSet.FieldDef} the field definition instance&lt;/li&gt;</span>
<span class="c">			 *        &lt;li&gt;name {string} the name of the field&lt;/li&gt;</span>
<span class="c">			 *        &lt;/ul&gt;</span>
<span class="c">			 * @param context {object} (optional) the context to execute the function in.  Defaults to this RecordSet</span>
<span class="c">			 */</span>
			<span class="nx">eachDef</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fn</span><span class="o">,</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_defs</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">_defs</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">def</span><span class="o">,</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="o">,</span><span class="nx">def</span><span class="o">,</span><span class="nx">def</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NAME</span><span class="p">));</span>
					<span class="p">}</span><span class="o">,</span> <span class="nx">context</span> <span class="o">||</span> <span class="k">this</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Loads the RecordSet with values read from the DataSource instance set in the &lt;code&gt;dataSource&lt;/code&gt; configuration attribute</span>
<span class="c">			 * @method sendRequest</span>
<span class="c">			 * @param request {mixed} Request to be passed to DataSource&#39;s sendRequest method</span>
<span class="c">			 */</span>
			<span class="nx">sendRequest</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">request</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">ds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">DATASOURCE</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">ds</span><span class="p">)</span> <span class="p">{</span>
					<span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>
					<span class="nx">ds</span><span class="p">.</span><span class="nx">sendRequest</span><span class="p">({</span>
						<span class="nx">request</span><span class="o">:</span> <span class="nx">request</span><span class="o">,</span>
						<span class="nx">callback</span><span class="o">:</span> <span class="p">{</span>
							<span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
								<span class="c">/**</span>
<span class="c">								 * Fires when data has been received and loaded</span>
<span class="c">								 * @event loadData</span>
<span class="c">								 * @param ev {event} Event object as received from DataSource.sendRequest</span>
<span class="c">								 */</span>
								<span class="nx">self</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="nx">LOAD_DATA_EVENT</span><span class="o">,</span><span class="p">{</span><span class="nx">defaultFn</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_defLoadData</span><span class="p">});</span>
								<span class="nx">self</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="nx">LOAD_DATA_EVENT</span><span class="o">,</span> <span class="nx">ev</span><span class="p">);</span>
							<span class="p">}</span><span class="o">,</span>
							<span class="nx">failure</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
								<span class="c">/**</span>
<span class="c">								 * Fires when data reception has failed</span>
<span class="c">								 * @event loadFail</span>
<span class="c">								 * @param ev {event} Event object as received from DataSource.sendRequest</span>
<span class="c">								 */</span>
								<span class="nx">self</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="nx">LOAD_FAIL_EVENT</span><span class="o">,</span><span class="nx">ev</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
							<span class="p">}</span>
						<span class="p">}</span>
					<span class="p">});</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Serializes the RecordSet in various formats according to attribute &lt;code&gt;serializeFormat&lt;/code&gt;.</span>
<span class="c">			 * If the serializer is not found, it will return the raw array of objects containing the fields to be serialized.</span>
<span class="c">			 * @method serialize</span>
<span class="c">			 * @return {string or [object]} Serialized fields</span>
<span class="c">			 */</span>
			<span class="nx">serialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">dirtyOnly</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">SERIALIZE_DIRTY_ONLY</span><span class="p">)</span><span class="o">,</span>
					<span class="nx">output</span> <span class="o">=</span> <span class="p">[]</span><span class="o">,</span> <span class="nx">recOut</span><span class="o">,</span>

					<span class="nx">formatter</span><span class="o">,</span> <span class="nx">type</span><span class="o">,</span>  <span class="nx">formatters</span> <span class="o">=</span> <span class="p">{}</span><span class="o">,</span> <span class="nx">primaryKeys</span> <span class="o">=</span> <span class="p">{};</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">eachDef</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">PRIMARY_KEY</span><span class="p">))</span> <span class="p">{</span>
						<span class="nx">primaryKeys</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
					<span class="p">}</span>
					<span class="nx">formatter</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;server.formatter&#39;</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">formatter</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">type</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span><span class="p">[</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)];</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">formatter</span> <span class="o">=</span> <span class="nx">type</span><span class="p">.</span><span class="nx">server</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">formatter</span><span class="o">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="nx">formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">formatter</span><span class="o">;</span>
				<span class="p">});</span>

					
				<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nx">dirtyOnly</span> <span class="o">||</span> <span class="nx">record</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">DIRTY</span><span class="p">))</span> <span class="p">{</span>
						<span class="nx">recOut</span> <span class="o">=</span> <span class="p">{};</span>
						<span class="nx">record</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">primaryKeys</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">||</span> <span class="o">!</span><span class="nx">dirtyOnly</span> <span class="o">||</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">DIRTY</span><span class="p">))</span> <span class="p">{</span>
								<span class="k">if</span> <span class="p">(</span><span class="nx">formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">])</span> <span class="p">{</span>
									<span class="nx">recOut</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">](</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">));</span>
								<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
									<span class="nx">recOut</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">);</span>
								<span class="p">}</span>
							<span class="p">}</span>
						<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
						<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">recOut</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="kd">var</span> <span class="nx">fn</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">SERIALIZE_FORMAT</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">fn</span><span class="p">))</span> <span class="p">{</span>
					<span class="nx">fn</span> <span class="o">=</span> <span class="nx">RecordSet</span><span class="p">.</span><span class="nx">Serializers</span><span class="p">[</span><span class="nx">fn</span><span class="p">];</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">return</span> <span class="nx">output</span><span class="o">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="o">,</span> <span class="nx">output</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Produces an HTML table out of the RecordSet.</span>
<span class="c">			 * It uses the structure and classNames of YUI2 DataTable but none of its functionality</span>
<span class="c">			 * @method tabulate</span>
<span class="c">			 * @param container {string} CSS3 selector for the container of the table</span>
<span class="c">			 */</span>
			<span class="nx">tabulate</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">container</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">formatter</span><span class="o">,</span> <span class="nx">type</span><span class="o">,</span>  <span class="nx">formatters</span> <span class="o">=</span> <span class="p">{};</span>
				
				<span class="c">// Resolve formatter to use for all fields and have them handy</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">eachDef</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">formatter</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;ui.formatter&#39;</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">formatter</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">type</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span><span class="p">[</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)];</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">formatter</span> <span class="o">=</span> <span class="nx">type</span><span class="p">.</span><span class="nx">ui</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">formatter</span><span class="o">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="nx">formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">formatter</span><span class="o">;</span>
				<span class="p">});</span>

				<span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;table&gt;&#39;</span><span class="p">]</span><span class="o">,</span> 
					<span class="nx">row</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;thead&gt;&lt;tr class=&quot;yui-dt-first yui-dt-last&quot;&gt;&#39;</span><span class="p">]</span><span class="o">,</span>
					<span class="nx">fds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defs</span><span class="o">,</span>
					<span class="nx">totalDepth</span> <span class="o">=</span> <span class="nx">fds</span><span class="p">.</span><span class="nx">getDepth</span><span class="p">()</span><span class="o">,</span>
					<span class="nx">lastDepth</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span>
					<span class="nx">childCount</span><span class="o">,</span>
					<span class="nx">fieldName</span><span class="o">,</span>
					<span class="nx">fieldNames</span> <span class="o">=</span> <span class="p">[]</span><span class="o">,</span>
					<span class="nx">fieldDef</span><span class="o">;</span>
				
				<span class="c">// Traverse the fields definitions in shallow order (by rows) to build the headings</span>
				<span class="nx">fds</span><span class="p">.</span><span class="nx">traverse</span><span class="p">(</span><span class="nx">FieldDefSet</span><span class="p">.</span><span class="nx">TRAVERSE_SHALLOW</span><span class="o">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span> <span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">fieldName</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NAME</span><span class="p">);</span>
					<span class="nx">childCount</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">getChildCount</span><span class="p">();</span>
					
					<span class="c">// Changed depth means it is a new row</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">depth</span> <span class="o">!=</span> <span class="nx">lastDepth</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">lastDepth</span> <span class="o">=</span> <span class="nx">depth</span><span class="o">;</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;/tr&gt;&lt;tr&gt;&#39;</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span><span class="s1">&#39;&lt;th class=&quot;yui-dt-col-{sanitizedKey}&quot; rowspan=&quot;{rowspan}&quot; colspan=&quot;{colspan}&quot;&gt;&lt;div class=&quot;yui-dt-liner&quot;&gt;&lt;span class=&quot;yui-dt-label&quot;&gt;{label}&lt;/span&gt;&lt;/div&gt;&lt;/th&gt;&#39;</span><span class="o">,</span> <span class="p">{</span>
						<span class="nx">fieldName</span><span class="o">:</span><span class="nx">fieldName</span><span class="o">,</span>
						<span class="nx">sanitizedKey</span><span class="o">:</span> <span class="nx">fieldName</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[^\w\-]/g</span><span class="o">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">,</span>
						<span class="kd">label</span><span class="o">:</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span><span class="o">,</span>
						<span class="nx">colspan</span><span class="o">:</span> <span class="nx">childCount</span> <span class="o">||</span> <span class="mi">1</span><span class="o">,</span>
						<span class="nx">rowspan</span><span class="o">:</span> <span class="p">(</span><span class="nx">childCount</span><span class="o">?</span><span class="mi">1</span><span class="o">:</span><span class="nx">totalDepth</span> <span class="o">-</span> <span class="nx">depth</span><span class="p">)</span>
					<span class="p">}));</span>
				<span class="p">});</span>
				<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;/tr&gt;&lt;/thead&gt;&#39;</span><span class="p">);</span>
				<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">row</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">JOINT</span><span class="p">));</span>
				
				<span class="c">// Traverse the fields defitinions leaves, that is, the ones that have the data</span>
				<span class="c">// and make a list of fieldNames in the proper order</span>
				<span class="c">// traverse() makes sure the order is the same as when it was defined</span>
				<span class="nx">fds</span><span class="p">.</span><span class="nx">traverse</span><span class="p">(</span><span class="nx">FieldDefSet</span><span class="p">.</span><span class="nx">TRAVERSE_LEAVES</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">fieldNames</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NAME</span><span class="p">));</span>
				<span class="p">});</span>
				
				<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;tbody class=&quot;yui-dt-data&quot;&gt;&#39;</span><span class="p">);</span>
				<span class="c">// For each record</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">record</span><span class="o">,</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">row</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;tr class=&quot;&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">index</span> <span class="o">===</span> <span class="mi">0</span><span class="o">?</span><span class="s1">&#39;yui-dt-first &#39;</span><span class="o">:</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="o">?</span><span class="s1">&#39;yui-dt-odd&#39;</span><span class="o">:</span><span class="s1">&#39;yui-dt-even&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">];</span>
					<span class="c">// read and process the fields in the order of a leaves-only traverse</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">fieldNames</span><span class="o">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">fieldDef</span> <span class="o">=</span> <span class="p">{</span>
							<span class="nx">value</span><span class="o">:</span> <span class="nx">record</span><span class="p">.</span><span class="nx">getField</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">)</span><span class="o">,</span>
							<span class="nx">sanitizedKey</span><span class="o">:</span> <span class="nx">fieldName</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[^\w\-]/g</span><span class="o">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
						<span class="p">};</span>
						<span class="nx">fieldDef</span><span class="p">.</span><span class="nx">formatted</span> <span class="o">=</span> <span class="p">(</span><span class="nx">formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span><span class="o">?</span><span class="nx">formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">](</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span><span class="o">:</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span><span class="s1">&#39;&lt;td class=&quot;yui-dt-col-{sanitizedKey}&quot;&gt;&lt;div class=&quot;yui-dt-liner&quot;&gt;{formatted}&lt;/div&gt;&lt;/td&gt;&#39;</span><span class="o">,</span> <span class="nx">fieldDef</span><span class="p">));</span>
					<span class="p">});</span>
					<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;/tr&gt;&#39;</span><span class="p">);</span>
					<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">row</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">JOINT</span><span class="p">));</span>
				<span class="p">});</span>
				<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;/tbody&gt;&lt;/table&gt;&#39;</span><span class="p">);</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">container</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;yui-dt&#39;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">output</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">JOINT</span><span class="p">)));</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Produces an HTML form out of a Record in the RecordSet.</span>
<span class="c">			 * I&#39;m not trying to be serious with this method, I&#39;m just showing a different traversal method and the possibility of building a form</span>
<span class="c">			 * from a Record instance.  The form doesn&#39;t even have &lt;code&gt;method&lt;/code&gt; or &lt;code&gt;action&lt;/code&gt; HTMLAttributes or buttons to submit it.</span>
<span class="c">			 * @method formalize</span>
<span class="c">			 * @param container {string} CSS3 selector for the container of the table</span>
<span class="c">			 * @param item {integer} Position of the record to be shown.</span>
<span class="c">			 * @param cfg {object} (optional) Additional configuration attributes such as &lt;ul&gt;</span>
<span class="c">			 * &lt;li&gt;&lt;code&gt;method&lt;/code&gt;: method for the form submit, defaults to GET&lt;/li&gt;</span>
<span class="c">			 * &lt;li&gt;&lt;code&gt;action&lt;/code&gt;: action attribute for the form, defaults to #&lt;/li&gt;</span>
<span class="c">			 * &lt;li&gt;&lt;code&gt;pager&lt;/code&gt;: selector to locate the container for the record paginator&lt;/li&gt;</span>
<span class="c">			 * &lt;li&gt;&lt;code&gt;submitLabel&lt;/code&gt;: label to be shown in the submit button&lt;/li&gt;</span>
<span class="c">			 */</span>
			 <span class="nx">formalize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">container</span><span class="o">,</span> <span class="nx">index</span><span class="o">,</span> <span class="nx">cfg</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">formatter</span><span class="o">,</span> <span class="nx">type</span><span class="o">,</span>  <span class="nx">formatters</span> <span class="o">=</span> <span class="p">{}</span><span class="o">,</span> <span class="nx">editor</span><span class="o">,</span> <span class="nx">editors</span> <span class="o">=</span> <span class="p">{}</span><span class="o">,</span> <span class="nx">pager</span><span class="o">,</span> <span class="nx">output</span><span class="o">;</span>
				
				<span class="k">if</span> <span class="p">(</span><span class="nx">cfg</span><span class="p">.</span><span class="nx">pager</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">pager</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">cfg</span><span class="p">.</span><span class="nx">pager</span><span class="p">)))</span> <span class="p">{</span>
					<span class="nx">output</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;div class=&quot;yui3-pager&quot;&gt;&lt;a href=&quot;#0&quot;&gt;&amp;lt;&amp;lt;&lt;/a&gt; &lt;a href=&quot;#-&quot;&gt;&amp;lt;&lt;/a&gt; &#39;</span><span class="p">];</span>
					<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">size</span><span class="p">();</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;a href=&quot;#&#39;</span><span class="p">);</span>
						<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
						<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">);</span>
						<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
						<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;/a&gt; &#39;</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;a href=&quot;#+&quot;&gt;&amp;gt;&lt;/a&gt; &lt;a href=&quot;#&#39;</span><span class="p">);</span>
					<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
					<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&quot;&gt;&amp;gt;&amp;gt;&lt;/a&gt;&#39;</span><span class="p">);</span>
					<span class="nx">pager</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="o">,</span><span class="nx">output</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">JOINT</span><span class="p">));</span>
				<span class="p">}</span>
				
				<span class="c">// Resolve formatter to use for all fields and have them handy</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">eachDef</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">formatter</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;ui.formatter&#39;</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">formatter</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">type</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span><span class="p">[</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)];</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">formatter</span> <span class="o">=</span> <span class="nx">type</span><span class="p">.</span><span class="nx">ui</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">formatter</span><span class="o">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="nx">formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">formatter</span><span class="o">;</span>
					<span class="nx">editor</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;ui.editor&#39;</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">editor</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">type</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span><span class="p">[</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)];</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">editor</span> <span class="o">=</span> <span class="nx">type</span><span class="p">.</span><span class="nx">ui</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">editor</span><span class="o">;</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="nx">editors</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">editor</span><span class="o">;</span>
				<span class="p">});</span>	
				<span class="nx">output</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;form method=&quot;&#39;</span><span class="o">,</span> <span class="nx">cfg</span><span class="p">.</span><span class="nx">method</span> <span class="o">||</span> <span class="s1">&#39;GET&#39;</span><span class="o">,</span> <span class="s1">&#39;&quot; action=&quot;&#39;</span> <span class="o">,</span><span class="nx">cfg</span><span class="p">.</span><span class="nx">action</span> <span class="o">||</span> <span class="s1">&#39;#&#39;</span> <span class="o">,</span> <span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">];</span>
				<span class="kd">var</span> <span class="nx">row</span><span class="o">,</span>
					<span class="nx">fds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defs</span><span class="o">,</span>
					<span class="nx">childCount</span><span class="o">,</span>
					<span class="nx">fieldName</span><span class="o">,</span>
					<span class="nx">fieldId</span><span class="o">,</span>
					<span class="nx">fieldNames</span> <span class="o">=</span> <span class="p">[]</span><span class="o">,</span>
					<span class="nx">fieldDef</span><span class="o">,</span>
					<span class="nx">stack</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;&lt;input disabled=&quot;true&quot; class=&quot;yui-form-button&quot; type=&quot;submit&quot; value=&quot;&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">cfg</span><span class="p">.</span><span class="nx">submitLabel</span> <span class="o">||</span> <span class="s1">&#39;Ok&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&lt;/form&gt;&#39;</span><span class="p">]</span><span class="o">,</span>
					<span class="nx">settings</span><span class="o">,</span>
					<span class="nx">record</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
				<span class="nx">fds</span><span class="p">.</span><span class="nx">traverse</span><span class="p">(</span><span class="nx">FieldDefSet</span><span class="p">.</span><span class="nx">TRAVERSE_DEEP</span><span class="o">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span> <span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">row</span> <span class="o">=</span> <span class="p">[];</span>
					<span class="k">while</span> <span class="p">(</span><span class="nx">stack</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">stack</span><span class="p">.</span><span class="nx">pop</span><span class="p">());</span>
					<span class="p">}</span>
					<span class="nx">fieldName</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NAME</span><span class="p">);</span>				
					<span class="nx">childCount</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">getChildCount</span><span class="p">();</span>		
					<span class="k">if</span> <span class="p">(</span><span class="nx">childCount</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;fieldset&gt;&lt;legend&gt;&#39;</span><span class="p">);</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">));</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;/legend&gt;&#39;</span><span class="p">);</span>
						<span class="nx">stack</span><span class="p">[</span><span class="nx">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&lt;/fieldset&gt;&#39;</span><span class="o">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;div class=&quot;yui-form-fieldset-container&quot;&gt;&lt;label for=&quot;yui-field-&#39;</span><span class="p">);</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">);</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">);</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">));</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&lt;/label&gt;&lt;div class=&quot;yui-form-field-container&quot; id=&quot;yui-field-container-&#39;</span><span class="p">);</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">);</span>
						<span class="nx">row</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">row</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">JOINT</span><span class="p">));</span>
				<span class="p">});</span>
				<span class="k">while</span><span class="p">(</span><span class="nx">stack</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">stack</span><span class="p">.</span><span class="nx">pop</span><span class="p">());</span>
				<span class="p">}</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">container</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;yui-form&#39;</span><span class="p">).</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="o">,</span><span class="nx">output</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">JOINT</span><span class="p">));</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">editors</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">editor</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">settings</span> <span class="o">=</span> <span class="p">{</span>
						<span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;yui-field-&#39;</span> <span class="o">+</span> <span class="nx">fieldName</span><span class="o">,</span>
						<span class="nx">name</span><span class="o">:</span> <span class="nx">fieldName</span><span class="o">,</span>
						<span class="nx">value</span><span class="o">:</span> <span class="p">(</span><span class="nx">formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span><span class="o">?</span><span class="nx">formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">](</span><span class="nx">record</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">))</span><span class="o">:</span><span class="nx">record</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">))</span>
					<span class="p">};</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">editor</span><span class="p">)</span> <span class="p">{</span>
						<span class="p">(</span><span class="k">new</span> <span class="nx">editor</span><span class="p">(</span><span class="nx">settings</span><span class="p">).</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;#yui-field-container-&#39;</span> <span class="o">+</span> <span class="nx">fieldName</span><span class="p">));</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;#yui-field-container-&#39;</span> <span class="o">+</span> <span class="nx">fieldName</span><span class="p">).</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="o">,</span>
							<span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span><span class="s1">&#39;&lt;input type=&quot;text&quot; id=&quot;{id}&quot; name=&quot;{name}&quot; value=&quot;{value}&quot; /&gt;&#39;</span><span class="o">,</span><span class="nx">settings</span><span class="p">));</span>
					<span class="p">}</span>
				<span class="p">});</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="nx">ATTRS</span><span class="o">:</span> <span class="p">{</span>
				<span class="c">/**</span>
<span class="c">				 * Holds a reference to the FieldDefSet instance which defines the properties of the Records stored</span>
<span class="c">				 * @attribute fieldDefSet</span>
<span class="c">				 * @type FieldDefSet</span>
<span class="c">				 */</span>
				<span class="nx">fieldDefSet</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">value</span> <span class="k">instanceof</span> <span class="nx">FieldDefSet</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
					<span class="p">}</span><span class="o">,</span>
					<span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">value</span> <span class="k">instanceof</span> <span class="nx">FieldDefSet</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
								<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_createFieldDef</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Attribute</span><span class="p">.</span><span class="nx">INVALID_VALUE</span><span class="o">;</span>
							<span class="p">}</span>
						<span class="p">}</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_defs</span> <span class="o">=</span> <span class="nx">value</span><span class="o">;</span>
						<span class="k">return</span> <span class="nx">value</span><span class="o">;</span>
					<span class="p">}</span><span class="o">,</span>
					<span class="nx">getter</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_defs</span><span class="o">;</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Instance of DataSource to use for loading the RecordSet</span>
<span class="c">				 * @attribute dataSource</span>
<span class="c">				 * @type Y.DataSource</span>
<span class="c">				 * @default null</span>
<span class="c">				 */</span>
				<span class="nx">dataSource</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">return</span> <span class="nx">value</span> <span class="k">instanceof</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataSource</span><span class="p">.</span><span class="nx">Local</span><span class="o">;</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Format of the RecordSet serialization. </span>
<span class="c">				 * Can be any of the properties in &lt;a href=&quot;#property_RecordSet.Serializers&quot;&gt;&lt;code&gt;RecordSet.Serializers&lt;/code&gt;&lt;/a&gt; (built in or added by the developer)</span>
<span class="c">				 * or a function that will receive an object to serialize and should return a string</span>
<span class="c">				 * @attribute serializeFormat</span>
<span class="c">				 * @type string or function</span>
<span class="c">				 * @default &quot;JSON&quot;</span>
<span class="c">				 */</span>
				<span class="nx">serializeFormat</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;JSON&#39;</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">return</span> <span class="p">(</span><span class="nx">value</span> <span class="k">in</span> <span class="nx">RecordSet</span><span class="p">.</span><span class="nx">Serializers</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNull</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Signals that only dirty fields should be included in the serialization</span>
<span class="c">				 * @attribute serializeDirtyOnly</span>
<span class="c">				 * @type Boolean</span>
<span class="c">				 * @default true</span>
<span class="c">				 */</span>
				 
				<span class="nx">serializeDirtyOnly</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="kc">true</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isBoolean</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/** </span>
<span class="c">				 * Signals if the RecordSet is sorted, on which field and in which direction.</span>
<span class="c">				 * It contains: &lt;ul&gt;</span>
<span class="c">				 * &lt;li&gt;&lt;code&gt;fieldName&lt;/code&gt;: Name of the field it is sorted by</span>
<span class="c">				 * &lt;li&gt;&lt;code&gt;desc&lt;/code&gt;: true if sort was descending</span>
<span class="c">				 * &lt;/ul&gt;</span>
<span class="c">				 * @attribute sortedBy</span>
<span class="c">				 * @type object</span>
<span class="c">				 * @default null (not sorted)</span>
<span class="c">				 */</span>
				 <span class="nx">sortedBy</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isNull</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="o">?</span><span class="nx">value</span><span class="p">.</span><span class="nx">fieldName</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="o">:</span> <span class="kc">true</span><span class="o">;</span>
							<span class="c">// I&#39;ll let &#39;desc&#39; take any Booleanish value, even undefined</span>
						<span class="p">}</span>
						<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Function to sort records by.  If none provided (the default) regular comparisons will be used.</span>
<span class="c">				 * The function will receive:&lt;/ol&gt;</span>
<span class="c">				 * &lt;li&gt;&lt;code&gt;a&lt;/code&gt;: first record to compare&lt;/li&gt;</span>
<span class="c">				 * &lt;li&gt;&lt;code&gt;b&lt;/code&gt;: second record to compare&lt;/li&gt;</span>
<span class="c">				 * &lt;li&gt;&lt;code&gt;desc&lt;/code&gt;: Boolean indicating the sort should be in descending order</span>
<span class="c">				 * &lt;li&gt;&lt;code&gt;fieldName&lt;/code&gt;: Name of the field to sort by</span>
<span class="c">				 * &lt;/ol&gt;</span>
<span class="c">				 * @attribute sortCompareFunction</span>
<span class="c">				 * @type function or null</span>
<span class="c">				 * @default null.</span>
<span class="c">				 */</span>
				<span class="nx">sortCompareFunction</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">return</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">||</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNull</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Serializes an array of objects in www-url-encoded format</span>
<span class="c">			 * @method serializeURL</span>
<span class="c">			 * @param array {array} Array of objects to serialize</span>
<span class="c">			 * @return {string} www-url-encoded output</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">serializeURL</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="p">[]</span><span class="o">,</span>
					<span class="nx">serializeRow</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="o">,</span> <span class="nx">suffix</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">suffix</span> <span class="o">=</span> <span class="nx">suffix</span> <span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">;</span>
						<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">array</span><span class="p">[</span><span class="nx">item</span><span class="p">]</span><span class="o">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="o">,</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">fieldName</span> <span class="o">+</span> <span class="nx">suffix</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;=&#39;</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">value</span><span class="p">));</span>
						<span class="p">});</span>
					<span class="p">};</span>
				
				<span class="nx">switch</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">case</span> <span class="mi">0</span><span class="o">:</span>
						<span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">;</span>
					<span class="nx">case</span> <span class="mi">1</span><span class="o">:</span>
						<span class="nx">serializeRow</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
						<span class="k">break</span><span class="o">;</span>
					<span class="nx">default</span><span class="o">:</span> 
						<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="o">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">serializeRow</span><span class="p">(</span><span class="nx">i</span><span class="o">,</span><span class="nx">i</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="o">;</span>
				<span class="p">}</span>
				<span class="k">return</span> <span class="nx">output</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
							
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/** </span>
<span class="c">			 * Hash containing the list of serializers available.  </span>
<span class="c">			 * The developer is expected to add to this list, if so wished.</span>
<span class="c">			 * The following serializers are already set:</span>
<span class="c">			 * &lt;ul&gt;&lt;li&gt;&quot;JSON&quot;&lt;/li&gt;&lt;li&gt;&quot;XML&quot;&lt;/li&gt;&lt;li&gt;&quot;URL&quot;&lt;/li&gt;&lt;/ul&gt;</span>
<span class="c">			 * @property RecordSet.Serializers</span>
<span class="c">			 * @type {object}</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">Serializers</span><span class="o">:</span> <span class="p">{}</span>
		<span class="p">}</span>
	<span class="p">);</span>

	<span class="nx">Y</span><span class="p">.</span><span class="nx">augment</span><span class="p">(</span><span class="nx">RecordSet</span><span class="o">,</span><span class="nx">Y</span><span class="p">.</span><span class="nx">ArrayList</span><span class="p">);</span>
	<span class="nx">Y</span><span class="p">[</span><span class="nx">RECORDSET</span><span class="p">]</span> <span class="o">=</span> <span class="nx">RecordSet</span><span class="o">;</span>

	<span class="kd">var</span> <span class="nx">FORM</span> <span class="o">=</span> <span class="s1">&#39;Form&#39;</span><span class="o">,</span>
		<span class="nx">PAGER</span> <span class="o">=</span> <span class="s1">&#39;pager&#39;</span><span class="o">,</span>
		<span class="nx">METHOD</span> <span class="o">=</span> <span class="s1">&#39;method&#39;</span><span class="o">,</span>
		<span class="nx">ACTION</span> <span class="o">=</span> <span class="s1">&#39;action&#39;</span><span class="o">,</span>
		<span class="nx">RECORDSET_ATTR</span> <span class="o">=</span> <span class="s1">&#39;recordSet&#39;</span><span class="o">,</span>
		<span class="nx">BASE_FIELD</span> <span class="o">=</span> <span class="s1">&#39;BaseField&#39;</span><span class="o">,</span>
		<span class="nx">TEXTBOX_FIELD</span> <span class="o">=</span> <span class="s1">&#39;TextBoxField&#39;</span><span class="o">,</span>
		<span class="nx">UNEDITABLE_FIELD</span> <span class="o">=</span> <span class="s1">&#39;UneditableField&#39;</span><span class="o">,</span>
		<span class="nx">INDEX</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="o">,</span>
		<span class="nx">classNames</span> <span class="o">=</span> <span class="p">{</span>
			<span class="nx">c_form</span><span class="o">:</span> <span class="nx">getClassName</span><span class="p">(</span><span class="nx">FORM</span><span class="p">)</span><span class="o">,</span>
			<span class="nx">c_content</span><span class="o">:</span> <span class="nx">getClassName</span><span class="p">(</span><span class="nx">FORM</span><span class="o">,</span> <span class="s1">&#39;content&#39;</span><span class="p">)</span><span class="o">,</span>
			<span class="nx">c_buttons</span><span class="o">:</span> <span class="nx">getClassName</span><span class="p">(</span><span class="nx">FORM</span><span class="o">,</span> <span class="s1">&#39;buttons&#39;</span><span class="p">)</span><span class="o">,</span>
			<span class="nx">c_submit</span><span class="o">:</span> <span class="nx">getClassName</span><span class="p">(</span><span class="nx">FORM</span><span class="o">,</span> <span class="s1">&#39;submit&#39;</span><span class="p">)</span><span class="o">,</span>
			<span class="nx">c_clear</span><span class="o">:</span> <span class="nx">getClassName</span><span class="p">(</span><span class="nx">FORM</span><span class="o">,</span> <span class="s1">&#39;clear&#39;</span><span class="p">)</span><span class="o">,</span>
			<span class="nx">c_input</span><span class="o">:</span> <span class="nx">getClassName</span><span class="p">(</span><span class="nx">BASE_FIELD</span><span class="o">,</span> <span class="s1">&#39;input&#39;</span><span class="p">)</span>
		<span class="p">};</span>
		
	<span class="c">/**</span>
<span class="c">	 * Base for form input fields.  It displays a textBox.</span>
<span class="c">	 * @class Form.BaseField</span>
<span class="c">	 * @extends Widget</span>
<span class="c">	 */</span>
	<span class="kd">var</span> <span class="nx">BaseField</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
		<span class="nx">BASE_FIELD</span><span class="o">,</span>
		<span class="nx">Y</span><span class="p">.</span><span class="nx">Widget</span><span class="o">,</span>
		<span class="p">[]</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Holds a reference to the actual input element</span>
<span class="c">			 * @property _input</span>
<span class="c">			 * @type HTMLElement</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_input</span><span class="o">:</span><span class="kc">null</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="nx">ATTRS</span><span class="o">:</span> <span class="p">{</span>
				<span class="c">/**</span>
<span class="c">				 * Name to be given to this field</span>
<span class="c">				 * @attribute name</span>
<span class="c">				 * @type string</span>
<span class="c">				 * @default &#39;&#39;</span>
<span class="c">				 */</span>
				<span class="nx">name</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Text label to be shown along the input element</span>
<span class="c">				 * @attribute label</span>
<span class="c">				 * @type string</span>
<span class="c">				 * @default &#39;&#39;</span>
<span class="c">				 */</span>
				<span class="kd">label</span><span class="o">:</span><span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * ID attribute of the form element</span>
<span class="c">				 * @attribute formId</span>
<span class="c">				 * @type string</span>
<span class="c">				 * @default &#39;&#39;</span>
<span class="c">				 */</span>
				<span class="nx">formId</span><span class="o">:</span><span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span><span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Value to be shown or entered in this input box</span>
<span class="c">				 * @attribute value</span>
<span class="c">				 */</span>
				<span class="nx">value</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="o">,</span>
					<span class="nx">broadcast</span><span class="o">:</span><span class="mi">1</span><span class="o">,</span>
					<span class="nx">lazyAdd</span><span class="o">:</span> <span class="kc">false</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">);</span>
	
	<span class="kd">var</span> <span class="nx">TextBoxField</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
		<span class="nx">TEXTBOX_FIELD</span><span class="o">,</span>
		<span class="nx">BaseField</span><span class="o">,</span>
		<span class="p">[]</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Detaches event listeners</span>
<span class="c">			 * @method destructor</span>
<span class="c">			 */</span>
			<span class="nx">destructor</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;keyup&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onInputChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;paste&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onInputChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;reset&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onInputChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onInputChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;valueChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onValueChange</span><span class="p">);</span>	
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Renders the input element</span>
<span class="c">			 * @method renderUI</span>
<span class="c">			 */</span>
			<span class="nx">renderUI</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">cb</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;contentBox&#39;</span><span class="p">);</span>
				<span class="nx">cb</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span><span class="nx">TextBoxField</span><span class="p">.</span><span class="nx">FIELD_TEMPLATE</span><span class="o">,</span><span class="nx">classNames</span><span class="p">)</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttrs</span><span class="p">())));</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_input</span> <span class="o">=</span> <span class="nx">cb</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Sets listeners for changes in the input textbox and for changes in the value configuration attribute</span>
<span class="c">			 * @method bindUI</span>
<span class="c">			 */</span>
			<span class="nx">bindUI</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;keyup&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onInputChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;paste&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onInputChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;reset&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onInputChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onInputChange</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;valueChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onValueChange</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Called whenever there is any change in the input box.</span>
<span class="c">			 * @method _onInputChange</span>
<span class="c">			 * @param ev {Event}</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_onInputChange</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">VALUE</span><span class="o">,</span><span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">VALUE</span><span class="p">)</span><span class="o">,</span><span class="p">{</span><span class="nx">source</span><span class="o">:</span><span class="s1">&#39;ui&#39;</span><span class="p">});</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Called whenever the value attribute is changed</span>
<span class="c">			 * @method _onValueChange</span>
<span class="c">			 * @param ev {Event}</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			 
			<span class="nx">_onValueChange</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">source</span> <span class="o">===</span> <span class="s1">&#39;ui&#39;</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span><span class="o">;</span>
				<span class="p">}</span>
				<span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">newVal</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">VALUE</span><span class="o">,</span><span class="nx">value</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Template to build the label and input elements with.  </span>
<span class="c">			 * The template will have the classNames substituted in first and then the values</span>
<span class="c">			 * @property FIELD_TEMPLATE</span>
<span class="c">			 * @type string</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">FIELD_TEMPLATE</span><span class="o">:</span> <span class="s1">&#39;&lt;label for=&quot;{formId}-{name}&quot;&gt;{label}&lt;/label&gt;&lt;input class=&quot;{c_input}&quot; type=&quot;text&quot; autocomplete=&quot;off&quot; name=&quot;{name}&quot; id=&quot;{formId}-{name}&quot; /&gt;&#39;</span>
		<span class="p">}</span>
	<span class="p">);</span>
		
	<span class="kd">var</span> <span class="nx">UneditableField</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
		<span class="nx">UNEDITABLE_FIELD</span><span class="o">,</span>
		<span class="nx">BaseField</span><span class="o">,</span>
		<span class="p">[]</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Holds a reference to the SPAN element that shows the value of the field</span>
<span class="c">			 * @property _span</span>
<span class="c">			 * @type HTMLElement</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_span</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Detaches event listeners</span>
<span class="c">			 * @method destructor</span>
<span class="c">			 */</span>
			<span class="nx">destructor</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;valueChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onValueChange</span><span class="p">);</span>	
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Renders the hidden input element and the span that shows it</span>
<span class="c">			 * @method renderUI</span>
<span class="c">			 */</span>
			<span class="nx">renderUI</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">cb</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;contentBox&#39;</span><span class="p">);</span>
				<span class="nx">cb</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span><span class="nx">UneditableField</span><span class="p">.</span><span class="nx">FIELD_TEMPLATE</span><span class="o">,</span><span class="nx">classNames</span><span class="p">)</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttrs</span><span class="p">())));</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_input</span> <span class="o">=</span> <span class="nx">cb</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_span</span> <span class="o">=</span> <span class="nx">cb</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Sets listeners for changes in the value configuration attribute</span>
<span class="c">			 * @method bindUI</span>
<span class="c">			 */</span>
			<span class="nx">bindUI</span><span class="o">:</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;valueChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onValueChange</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			
			<span class="c">/**</span>
<span class="c">			 * Called whenever the value attribute is changed</span>
<span class="c">			 * @method _onValueChange</span>
<span class="c">			 * @param ev {Event}</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_onValueChange</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">newVal</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">_input</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">VALUE</span><span class="o">,</span><span class="nx">value</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_span</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">_span</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="o">,</span><span class="nx">value</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Template to build the label and input elements with.  </span>
<span class="c">			 * The template will have the classNames substituted in first and then the values</span>
<span class="c">			 * @property FIELD_TEMPLATE</span>
<span class="c">			 * @type string</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">FIELD_TEMPLATE</span><span class="o">:</span> <span class="s1">&#39;&lt;label&gt;{label}&lt;/label&gt;&lt;span  class=&quot;{c_input}&quot;&gt;{value}&lt;/span&gt;&lt;input type=&quot;hidden&quot; name=&quot;{name}&quot; id=&quot;{formId}-{name}&quot; /&gt;&#39;</span>
		<span class="p">}</span>
	<span class="p">);</span>

	<span class="c">/**</span>
<span class="c">	 * Handles an html form</span>
<span class="c">	 * @class Form</span>
<span class="c">	 * @extends Widget</span>
<span class="c">	 */</span>
	<span class="kd">var</span>	<span class="nx">Form</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
		<span class="nx">FORM</span><span class="o">,</span>
		<span class="nx">Y</span><span class="p">.</span><span class="nx">Widget</span><span class="o">,</span>
		<span class="p">[]</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Hash with UI formatters for each of the fields to be shown, indexed by field name</span>
<span class="c">			 * @property _formatters</span>
<span class="c">			 * @type object</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_formatters</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Hash with Form.Field instances for each of the fields, indexed by field name</span>
<span class="c">			 * @property _editors</span>
<span class="c">			 * @type object</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_editors</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Hash with Form.Field classes to be instanced for each of the fields, indexed by field name</span>
<span class="c">			 * @property _editorTypes</span>
<span class="c">			 * @type object</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_editorTypes</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Hash with parser to accept each of the fields when input, indexed by field name</span>
<span class="c">			 * @property _parsers</span>
<span class="c">			 * @type object</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_parsers</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Reference to the form element</span>
<span class="c">			 * @property _form</span>
<span class="c">			 * @type HTMLelement (form)</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_form</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Reference to the container element for the submit and other buttons in the form</span>
<span class="c">			 * @property _buttons</span>
<span class="c">			 * @type HTMLElement</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_buttons</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Reference to the current Record instance withing the RecordSet being shown </span>
<span class="c">			 * @property _currentRecord</span>
<span class="c">			 * @type Record</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_currentRecord</span><span class="o">:</span> <span class="kc">null</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Initializer called by Base</span>
<span class="c">			 * @method initializer</span>
<span class="c">			 * @param cfg {object} initial configuration attributes</span>
<span class="c">			 */</span>
			<span class="nx">initializer</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;recordSetChange&#39;</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fillConverters</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_fillConverters</span><span class="p">();</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_editors</span> <span class="o">=</span> <span class="p">{};</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;recordIndexChange&#39;</span><span class="o">,</span> <span class="p">{</span>	<span class="nx">defaultFn</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_defRecordIndexChange</span><span class="p">});</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_defRecordIndexChange</span><span class="p">();</span>
					
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Destructor called by Base</span>
<span class="c">			 * @method destructor</span>
<span class="c">			 */</span>
			<span class="nx">destructor</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_editors</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ed</span><span class="o">,</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">ed</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;valueChange&#39;</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fieldValueChanged</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;recordSetChange&#39;</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fillConverters</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;indexChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_defRecordIndexChange</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;recordSetChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_defRecordIndexChange</span><span class="p">);</span>
				<span class="kd">var</span> <span class="nx">pager</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">PAGER</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">pager</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">pager</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onPagerClick</span><span class="p">);</span>
				<span class="p">}</span>				
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Renderer called by Widget</span>
<span class="c">			 * @method renderUI</span>
<span class="c">			 */</span>
			<span class="nx">renderUI</span><span class="o">:</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_renderPager</span><span class="p">();</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_renderForm</span><span class="p">();</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Binds events in the widget, called by Widget</span>
<span class="c">			 * @bindUI</span>
<span class="c">			 */</span>
			<span class="nx">bindUI</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_bindPager</span><span class="p">();</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_bindForm</span><span class="p">();</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * synchs the internal state with the widget that shows it</span>
<span class="c">			 * @method syncUI</span>
<span class="c">			 */</span>
			<span class="nx">syncUI</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_syncForm</span><span class="p">();</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Reads the field definitions for each field looking either for the ui set of functions (parser, formatter and editor) </span>
<span class="c">			 * and stores it in the internal tables for later use.  If a field doesn&#39;t have a specific function, it will read</span>
<span class="c">			 * its type atribute and find the standard function for that type</span>
<span class="c">			 * @method _fillConverters</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_fillConverters</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">converter</span><span class="o">,</span> <span class="nx">type</span><span class="o">,</span>
					<span class="nx">rs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">RECORDSET_ATTR</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_formatters</span> <span class="o">=</span> <span class="p">{};</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_editorTypes</span> <span class="o">=</span> <span class="p">{};</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_parsers</span> <span class="o">=</span> <span class="p">{};</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">rs</span><span class="p">)</span> <span class="p">{</span>
					<span class="kd">var</span> <span class="nx">findConverter</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span><span class="nx">which</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">converter</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;ui.&#39;</span> <span class="o">+</span> <span class="nx">which</span><span class="p">);</span>
						<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">converter</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">type</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Types</span><span class="p">[</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)];</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
								<span class="nx">converter</span> <span class="o">=</span> <span class="nx">type</span><span class="p">.</span><span class="nx">ui</span> <span class="o">&amp;&amp;</span> <span class="nx">type</span><span class="p">.</span><span class="nx">ui</span><span class="p">[</span><span class="nx">which</span><span class="p">];</span>
							<span class="p">}</span>
						<span class="p">}</span>
						<span class="k">return</span> <span class="nx">converter</span><span class="o">;</span>
					<span class="p">};</span>
					<span class="nx">rs</span><span class="p">.</span><span class="nx">eachDef</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span> <span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">findConverter</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span><span class="s1">&#39;formatter&#39;</span><span class="p">);</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_editorTypes</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">findConverter</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span><span class="s1">&#39;editor&#39;</span><span class="p">);</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_parsers</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">findConverter</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span><span class="s1">&#39;parser&#39;</span><span class="p">);</span>
					<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>	
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Renders the pager</span>
<span class="c">			 * @method _renderPager</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_renderPager</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">pager</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">PAGER</span><span class="p">)</span><span class="o">,</span>
					<span class="nx">output</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;div class=&quot;yui3-pager&quot;&gt;&lt;a href=&quot;#0&quot;&gt;&amp;lt;&amp;lt;&lt;/a&gt; &lt;a href=&quot;#-&quot;&gt;&amp;lt;&lt;/a&gt; &#39;</span><span class="p">];</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">pager</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span><span class="o">;</span>
				<span class="p">}</span>
				<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">RECORDSET_ATTR</span><span class="p">).</span><span class="nx">size</span><span class="p">();</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;&lt;a href=&quot;#&#39;</span><span class="o">,</span> <span class="nx">i</span><span class="o">,</span> <span class="s1">&#39;&quot;&gt;&#39;</span><span class="o">,</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span>	<span class="s1">&#39;&lt;/a&gt; &#39;</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="nx">JOINT</span><span class="p">));</span>
				<span class="p">}</span>
				<span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="s1">&#39;&lt;a href=&quot;#+&quot;&gt;&amp;gt;&lt;/a&gt; &lt;a href=&quot;#&#39;</span><span class="o">,</span> <span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="s1">&#39;&quot;&gt;&amp;gt;&amp;gt;&lt;/a&gt;&#39;</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="nx">JOINT</span><span class="p">));</span>
				<span class="nx">pager</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">output</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">JOINT</span><span class="p">)));</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Binds the pager HTMLelements to the listener</span>
<span class="c">			 * @method _bindPager</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_bindPager</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">pager</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">PAGER</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">pager</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">pager</span><span class="p">.</span><span class="nx">delegate</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_onPagerClick</span><span class="o">,</span><span class="s1">&#39;a&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Responds to clicks on the pager controls to move about the Records</span>
<span class="c">			 * @method _onPagerClick</span>
<span class="c">			 * @param ev {Event}</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_onPagerClick</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="nx">ev</span><span class="p">.</span><span class="nx">halt</span><span class="p">();</span>
				<span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
				<span class="nx">switch</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">case</span> <span class="s1">&#39;+&#39;</span><span class="o">:</span>
						<span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">INDEX</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">RECORDSET_ATTR</span><span class="p">).</span><span class="nx">size</span><span class="p">())</span> <span class="p">{</span>
							<span class="nx">index</span><span class="o">--;</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="o">;</span>
					<span class="nx">case</span> <span class="s1">&#39;-&#39;</span><span class="o">:</span>
						<span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">INDEX</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
							<span class="nx">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="o">;</span>
					<span class="nx">default</span><span class="o">:</span>
						<span class="nx">index</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">index</span><span class="o">,</span><span class="mi">10</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">INDEX</span><span class="o">,</span><span class="nx">index</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_syncForm</span><span class="p">();</span>
			<span class="p">}</span><span class="o">,</span>

			<span class="c">/**</span>
<span class="c">			 * Binds the index and recordSet change events so the current record can be changed and the screen updated</span>
<span class="c">			 * @method _bindForm</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_bindForm</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span>  <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;indexChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_defRecordIndexChange</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;recordSetChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_defRecordIndexChange</span><span class="p">);</span>
				<span class="nx">Y</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_editors</span><span class="o">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ed</span><span class="o">,</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">ed</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;valueChange&#39;</span><span class="o">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_fieldValueChanged</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="s1">&#39;submit&#39;</span><span class="o">,</span><span class="p">{</span><span class="nx">defaultFn</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_defSubmitForm</span><span class="p">});</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;submit&#39;</span><span class="o">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">ev</span><span class="p">.</span><span class="nx">halt</span><span class="p">();</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">fire</span><span class="p">(</span><span class="s1">&#39;submit&#39;</span><span class="o">,</span><span class="p">{</span><span class="nx">form</span><span class="o">:</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">});</span>
				<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Default action for the Form:submit event, it submits the form.</span>
<span class="c">			 * @method _defSubmitForm</span>
<span class="c">			 * @param ev {Event}</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_defSubmitForm</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">submit</span><span class="p">();</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Renders the form and its input fields</span>
<span class="c">			 * @method _renderForm</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_renderForm</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">yuid</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">guid</span><span class="p">(</span><span class="nx">FORM</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">,</span>
					<span class="nx">container</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;contentBox&#39;</span><span class="p">)</span><span class="o">,</span>
					<span class="nx">rs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">RECORDSET_ATTR</span><span class="p">)</span><span class="o">,</span>
					<span class="nx">fds</span> <span class="o">=</span> <span class="nx">rs</span> <span class="o">&amp;&amp;</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">_defs</span><span class="o">,</span>
					<span class="nx">childCount</span><span class="o">,</span>
					<span class="nx">fieldName</span><span class="o">,</span>
					<span class="nx">editor</span><span class="o">;</span>
					
				<span class="k">this</span><span class="p">.</span><span class="nx">_form</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span><span class="nx">Form</span><span class="p">.</span><span class="nx">FORM_TEMPLATE</span><span class="o">,</span> <span class="nx">classNames</span><span class="p">)</span><span class="o">,</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttrs</span><span class="p">([</span><span class="nx">METHOD</span><span class="o">,</span><span class="nx">ACTION</span><span class="p">])</span><span class="o">,</span><span class="p">{</span><span class="nx">id</span><span class="o">:</span><span class="nx">yuid</span><span class="p">})</span>
				<span class="p">));</span>
				<span class="nx">container</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">);</span>
				
				<span class="kd">var</span> <span class="nx">stack</span> <span class="o">=</span> <span class="p">[</span><span class="nx">container</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;#content-&#39;</span> <span class="o">+</span> <span class="nx">yuid</span><span class="p">)];</span>
				<span class="nx">fds</span><span class="p">.</span><span class="nx">traverse</span><span class="p">(</span><span class="nx">FieldDefSet</span><span class="p">.</span><span class="nx">TRAVERSE_DEEP</span><span class="o">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span> <span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">fieldName</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NAME</span><span class="p">);</span>				
					<span class="nx">childCount</span> <span class="o">=</span> <span class="nx">fieldDef</span><span class="p">.</span><span class="nx">getChildCount</span><span class="p">();</span>		
					<span class="k">if</span> <span class="p">(</span><span class="nx">childCount</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">stack</span><span class="p">[</span><span class="nx">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span><span class="nx">Form</span><span class="p">.</span><span class="nx">FIELDSET_TEMPLATE</span><span class="o">,</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">getAttrs</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">])));</span>
						<span class="nx">stack</span><span class="p">[</span><span class="nx">depth</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">stack</span><span class="p">[</span><span class="nx">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="nx">editor</span> <span class="o">=</span> <span class="p">(</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">PRIMARY_KEY</span><span class="p">)</span><span class="o">?</span><span class="nx">UneditableField</span><span class="o">:</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_editorTypes</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">||</span> <span class="nx">TextBoxField</span><span class="p">));</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_editors</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">editor</span><span class="p">({</span>
							<span class="nx">name</span><span class="o">:</span><span class="nx">fieldName</span><span class="o">,</span>
							<span class="nx">formId</span><span class="o">:</span><span class="nx">yuid</span><span class="o">,</span>
							<span class="kd">label</span><span class="o">:</span><span class="nx">fieldDef</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
						<span class="p">}).</span><span class="nx">render</span><span class="p">(</span><span class="nx">stack</span><span class="p">[</span><span class="nx">depth</span><span class="p">]);</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_buttons</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Node</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span>
					<span class="nx">Y</span><span class="p">.</span><span class="nx">substitute</span><span class="p">(</span><span class="nx">Form</span><span class="p">.</span><span class="nx">BUTTON_TEMPLATE</span><span class="o">,</span> <span class="nx">classNames</span><span class="p">)</span><span class="o">,</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">getAttrs</span><span class="p">([</span><span class="s1">&#39;submitLabel&#39;</span><span class="p">]))</span>
				<span class="p">);</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_buttons</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Refreshes the elements in the form with the values in the current record</span>
<span class="c">			 * @method _syncForm</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_syncForm</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_currentRecord</span><span class="o">,</span>
					<span class="nx">formatter</span><span class="o">,</span> <span class="nx">editor</span><span class="o">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
					<span class="nx">r</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">fieldDef</span><span class="o">,</span><span class="nx">fieldName</span><span class="p">)</span> <span class="p">{</span>
						<span class="nx">formatter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_formatters</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">];</span>
						<span class="nx">editor</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_editors</span><span class="p">[</span><span class="nx">fieldName</span><span class="p">];</span>
						<span class="k">if</span> <span class="p">(</span><span class="nx">editor</span><span class="p">)</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="nx">formatter</span><span class="p">)</span> <span class="p">{</span>
								<span class="nx">editor</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">VALUE</span><span class="o">,</span><span class="nx">formatter</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">)));</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="nx">editor</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">VALUE</span><span class="o">,</span><span class="nx">r</span><span class="p">.</span><span class="nx">getValue</span><span class="p">(</span><span class="nx">fieldName</span><span class="p">));</span>
							<span class="p">}</span>
						<span class="p">}</span>
					
					<span class="p">}</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">_buttons</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;disabled&#39;</span><span class="o">,!</span><span class="nx">r</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">DIRTY</span><span class="p">));</span>
				<span class="p">}</span>				
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Default action for the recordIndexChange event, updates the current record</span>
<span class="c">			 * @method _defRecordIndexChange</span>
<span class="c">			 * @param ev {Event} event object</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_defRecordIndexChange</span><span class="o">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">rs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">RECORDSET_ATTR</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">rs</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_currentRecord</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_currentRecord</span><span class="p">.</span><span class="nx">detach</span><span class="p">(</span><span class="s1">&#39;dirtyChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_enableButtons</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">_currentRecord</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">INDEX</span><span class="p">));</span>
					<span class="k">this</span><span class="p">.</span><span class="nx">_currentRecord</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="s1">&#39;dirtyChange&#39;</span><span class="o">,</span><span class="k">this</span><span class="p">.</span><span class="nx">_enableButtons</span><span class="o">,</span><span class="k">this</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Enables the submit button if the record is dirty</span>
<span class="c">			 * @method _enableButtons</span>
<span class="c">			 * @param ev {Event}</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_enableButtons</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">this</span><span class="p">.</span><span class="nx">_buttons</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;disabled&#39;</span><span class="o">,!</span><span class="nx">ev</span><span class="p">.</span><span class="nx">newVal</span><span class="p">);</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Saves the value of any changed field to the Record object</span>
<span class="c">			 * @method _fieldValueChanged</span>
<span class="c">			 * @param ev {Event}</span>
<span class="c">			 * @private</span>
<span class="c">			 */</span>
			<span class="nx">_fieldValueChanged</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">source</span> <span class="o">===</span> <span class="s1">&#39;ui&#39;</span><span class="p">)</span> <span class="p">{</span>
					<span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">NAME</span><span class="p">)</span><span class="o">,</span>
						<span class="nx">parser</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_parsers</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
					<span class="k">if</span> <span class="p">(</span><span class="nx">parser</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_currentRecord</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">name</span><span class="o">,</span><span class="nx">parser</span><span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">newVal</span><span class="p">));</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="k">this</span><span class="p">.</span><span class="nx">_currentRecord</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="nx">name</span><span class="o">,</span><span class="nx">ev</span><span class="p">.</span><span class="nx">newVal</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="p">{</span>
			<span class="nx">ATTRS</span><span class="o">:</span> <span class="p">{</span>
				<span class="c">/**</span>
<span class="c">				 * Method to be used when submitting the form</span>
<span class="c">				 * @attribute method</span>
<span class="c">				 * @type string</span>
<span class="c">				 * @default &#39;GET&#39;</span>
<span class="c">				 */</span>
				<span class="nx">method</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="s1">&#39;GET&#39;</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Default action attribute for the form</span>
<span class="c">				 * @attribute action</span>
<span class="c">				 * @type string</span>
<span class="c">				 * @default &#39;#&#39;</span>
<span class="c">				 */</span>
				<span class="nx">action</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="s1">&#39;#&#39;</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Label for the submit button</span>
<span class="c">				 * @attribute submitLabel</span>
<span class="c">				 * @type string</span>
<span class="c">				 * @default &#39;Ok&#39;</span>
<span class="c">				 */</span>
				<span class="nx">submitLabel</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="s1">&#39;Ok&#39;</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isString</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Container for the pager, if any</span>
<span class="c">				 * @attribute pager</span>
<span class="c">				 * @type HTMLElement</span>
<span class="c">				 * @default null</span>
<span class="c">				 */</span>
				<span class="nx">pager</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
					<span class="nx">setter</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">one</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
						<span class="k">return</span> <span class="p">(</span><span class="nx">p</span><span class="o">?</span><span class="nx">p</span><span class="o">:</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Attribute</span><span class="p">.</span><span class="nx">INVALID_VALUE</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * RecordSet holding the record being shown</span>
<span class="c">				 * @attribute recordSet</span>
<span class="c">				 * @type RecordSet</span>
<span class="c">				 * @default null</span>
<span class="c">				 */</span>
				<span class="nx">recordSet</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="kc">null</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">return</span> <span class="nx">value</span> <span class="k">instanceof</span> <span class="nx">RecordSet</span><span class="o">;</span>
					<span class="p">}</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="c">/**</span>
<span class="c">				 * Index of the Record to be shown</span>
<span class="c">				 * @attribute index</span>
<span class="c">				 * @type integer</span>
<span class="c">				 * @default 0</span>
<span class="c">				 */</span>
				<span class="nx">index</span><span class="o">:</span> <span class="p">{</span>
					<span class="nx">value</span><span class="o">:</span><span class="mi">0</span><span class="o">,</span>
					<span class="nx">validator</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">return</span> <span class="nx">Lang</span><span class="p">.</span><span class="nx">isNumber</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">RECORDSET_ATTR</span><span class="p">).</span><span class="nx">size</span><span class="p">();</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Template to be used in building the form.</span>
<span class="c">			 * @property FORM_TEMPLATE</span>
<span class="c">			 * @type string</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">FORM_TEMPLATE</span><span class="o">:</span> <span class="s1">&#39;&lt;form id=&quot;{id}&quot; class=&quot;{c_form}&quot; method=&quot;{method}&quot; action=&quot;{action}&quot;&gt;&lt;div class=&quot;{c_content}&quot; id=&quot;content-{id}&quot;&gt;&lt;/div&gt;&lt;div class=&quot;{c_buttons}&quot; id=&quot;buttons-{id}&quot;&gt;&lt;/div&gt;&lt;/form&gt;&#39;</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Template to be used in building all fieldset elements.</span>
<span class="c">			 * @property FIELDSET_TEMPLATE</span>
<span class="c">			 * @type string</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">FIELDSET_TEMPLATE</span><span class="o">:</span> <span class="s1">&#39;&lt;fieldset&gt;&lt;legend&gt;{label}&lt;/legend&gt;&lt;/fieldset&gt;&#39;</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Template to be used in building the buttons in the form.</span>
<span class="c">			 * @property BUTTON_TEMPLATE</span>
<span class="c">			 * @type string</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">BUTTON_TEMPLATE</span><span class="o">:</span><span class="s1">&#39;&lt;input class=&quot;{c_submit}&quot; disabled=&quot;true&quot; class=&quot;yui-form-button&quot; type=&quot;submit&quot; value=&quot;{submitLabel}&quot; /&gt;&#39;</span>
		<span class="p">}</span>
	<span class="p">);</span>
	<span class="nx">Y</span><span class="p">[</span><span class="nx">FORM</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Form</span><span class="o">;</span>
	<span class="nx">Y</span><span class="p">[</span><span class="nx">FORM</span><span class="p">][</span><span class="nx">BASE_FIELD</span><span class="p">]</span> <span class="o">=</span> <span class="nx">BaseField</span><span class="o">;</span>
	<span class="nx">Y</span><span class="p">[</span><span class="nx">FORM</span><span class="p">][</span><span class="nx">TEXTBOX_FIELD</span><span class="p">]</span> <span class="o">=</span> <span class="nx">TextBoxField</span><span class="o">;</span>
	<span class="nx">Y</span><span class="p">[</span><span class="nx">FORM</span><span class="p">][</span><span class="nx">UNEDITABLE_FIELD</span><span class="p">]</span> <span class="o">=</span> <span class="nx">UneditableField</span><span class="o">;</span>

	
	<span class="c">/**</span>
<span class="c">	 * Contains a list of converters (parsers and formatters) for several standard formats.</span>
<span class="c">	 * The developer is expected to add custom application converters for his/her own data types to this list.</span>
<span class="c">	 * @class DataType.Converters</span>
<span class="c">	 *</span>
<span class="c">	 */</span>
	
	<span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">namespace</span><span class="p">(</span><span class="s1">&#39;DataType.Converters&#39;</span><span class="p">)</span><span class="o">,</span> <span class="p">{</span>
		<span class="c">/**</span>
<span class="c">		 * Converters for dates used in SQL, DD-MM-YYYY hh:mm:ss</span>
<span class="c">		 * @property DataType.Converters.SQLDate</span>
<span class="c">		 * @type object</span>
<span class="c">		 * @static</span>
<span class="c">		 */</span>
		<span class="nx">SQLDate</span><span class="o">:</span> <span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Parses a date in SQL format  YYYY-MM-DD hh:mm:ss (the time being optional) into a Date() object instance</span>
<span class="c">			 * @property DataType.Converters.SQLDate.parser</span>
<span class="c">			 * @type function</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">parser</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
				<span class="kd">var</span> <span class="nx">datePart</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="nx">parts</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
					<span class="kd">var</span> <span class="nx">timePart</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">);</span>
					<span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">datePart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="nx">datePart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="nx">datePart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">,</span><span class="nx">timePart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="nx">timePart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">,</span><span class="nx">timePart</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">datePart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="nx">datePart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="nx">datePart</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="c">/**</span>
<span class="c">			 * Formats a Date() object instance into a date in SQL format  YYYY-MM-DD hh:mm:ss</span>
<span class="c">			 * @property DataType.Converters.SQLDate.formatter</span>
<span class="c">			 * @type function</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">formatter</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nb">Date</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">value</span><span class="o">,</span><span class="p">{</span><span class="nx">format</span><span class="o">:</span><span class="s1">&#39;%Y-%m-%d %T&#39;</span><span class="p">});</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Converters for dates used in DD/MM/YYYY format.</span>
<span class="c">		 * Actually, this should use localized formatters and parsers, but DataType.Date.parse does not take locales.</span>
<span class="c">		 * @property DataType.Converters.dmyDate</span>
<span class="c">		 * @type object</span>
<span class="c">		 * @static</span>
<span class="c">		 */</span>
		<span class="nx">dmyDate</span><span class="o">:</span> <span class="p">{</span>
			<span class="c">/**</span>
<span class="c">			 * Parses a date in DD/MM/YYYY format into a Date() object instance</span>
<span class="c">			 * @property DataType.Converters.dmyDate.parser</span>
<span class="c">			 * @type function</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">parser</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
				<span class="kd">var</span> <span class="nx">datePart</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
				<span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">datePart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">,</span><span class="nx">datePart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="nx">datePart</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
			<span class="p">}</span><span class="o">,</span>
				
			<span class="c">/**</span>
<span class="c">			 * Formats a Date() object instance into a date in DD/MM/YYYY format</span>
<span class="c">			 * @property DataType.Converters.dmyDate.formatter</span>
<span class="c">			 * @type function</span>
<span class="c">			 * @static</span>
<span class="c">			 */</span>
			<span class="nx">formatter</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nb">Date</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">value</span><span class="o">,</span><span class="p">{</span><span class="nx">format</span><span class="o">:</span><span class="s1">&#39;%d/%m/%Y&#39;</span><span class="p">});</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">});</span>
	
	<span class="c">/**</span>
<span class="c">	 * Contains a list of converters (and eventually other info) for several types of data, keyed by a given name.</span>
<span class="c">	 * The developer is expected to add custom application types to this list.</span>
<span class="c">	 * @class DataType.Types</span>
<span class="c">	 */</span>
	<span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">namespace</span><span class="p">(</span><span class="s1">&#39;DataType.Types&#39;</span><span class="p">)</span><span class="o">,</span> <span class="p">{</span>
		<span class="c">/**</span>
<span class="c">		 * Just a fake type for testing purposes.</span>
<span class="c">		 * @property DataType.Types.padded</span>
<span class="c">		 * @static</span>
<span class="c">		 */</span>
		<span class="nx">padded</span><span class="o">:</span> <span class="p">{</span>
			<span class="nx">server</span><span class="o">:</span> <span class="p">{</span>
				<span class="nx">parser</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span> <span class="s1">&#39;===[&#39;</span> <span class="o">+</span> <span class="nx">value</span> <span class="o">+</span> <span class="s1">&#39;]===&#39;</span><span class="o">;</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="nx">formatter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span>  <span class="nx">value</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">4</span><span class="o">,</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span><span class="mi">8</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="nx">ui</span><span class="o">:</span> <span class="p">{</span>
				<span class="nx">parser</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span> <span class="s1">&#39;===[&#39;</span> <span class="o">+</span> <span class="nx">value</span> <span class="o">+</span> <span class="s1">&#39;]===&#39;</span><span class="o">;</span>
				<span class="p">}</span><span class="o">,</span>
				<span class="nx">formatter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span>  <span class="nx">value</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">4</span><span class="o">,</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span><span class="mi">8</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Standard number parsers</span>
<span class="c">		 * @property DataType.Types.number</span>
<span class="c">		 * @type object</span>
<span class="c">		 * @static</span>
<span class="c">		 */</span>
		<span class="nx">number</span><span class="o">:</span> <span class="p">{</span>
			<span class="nx">server</span><span class="o">:</span> <span class="p">{</span>
				<span class="nx">parser</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span><span class="o">,</span>
			<span class="nx">ui</span><span class="o">:</span> <span class="p">{</span>
				<span class="nx">parser</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">return</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span><span class="o">,</span>
		<span class="c">/**</span>
<span class="c">		 * Another custom type for testing. </span>
<span class="c">		 * It references two DataType.Converters for server-side and ui-side conversions</span>
<span class="c">		 * @property DataType.Types.myDate</span>
<span class="c">		 * @type object</span>
<span class="c">		 * @static</span>
<span class="c">		 */</span>
		<span class="nx">myDate</span><span class="o">:</span> <span class="p">{</span>
			<span class="nx">server</span><span class="o">:</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Converters</span><span class="p">.</span><span class="nx">SQLDate</span><span class="o">,</span>
			<span class="nx">ui</span><span class="o">:</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">DataType</span><span class="p">.</span><span class="nx">Converters</span><span class="p">.</span><span class="nx">dmyDate</span>
		<span class="p">}</span>
					

	<span class="p">});</span>
<span class="p">}</span><span class="o">,</span><span class="s1">&#39;0.9&#39;</span><span class="o">,</span><span class="p">{</span><span class="nx">requires</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;base&#39;</span><span class="o">,</span><span class="s1">&#39;collection&#39;</span><span class="o">,</span><span class="s1">&#39;record&#39;</span><span class="o">,</span><span class="s1">&#39;datatype&#39;</span><span class="o">,</span><span class="s1">&#39;widget&#39;</span><span class="o">,</span><span class="s1">&#39;substitute&#39;</span><span class="p">]</span><span class="o">,</span><span class="nx">optional</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;json&#39;</span><span class="p">]});</span>
</pre></div>
                    </div>
			</div>
		</div>
		<div class="yui-b">
            <div class="nav">

                    <div id="moduleList" class="module">
                        <h4>Modules</h4>
                        <ul class="content">
                                <li class="selected"><a href="module_recordset.html" title="recordset">recordset</a></li>
                        </ul>
                    </div>

                    <div id="classList" class="module">
                        <h4>Classes</h4>
                        <ul class="content">
                                <li class=""><a href="DataType.Converters.html" title="DataType.Converters">DataType.Converters</a></li>
                                <li class=""><a href="DataType.Types.html" title="DataType.Types">DataType.Types</a></li>
                                <li class=""><a href="FieldDef.html" title="FieldDef">FieldDef</a></li>
                                <li class=""><a href="FieldDefSet.html" title="FieldDefSet">FieldDefSet</a></li>
                                <li class=""><a href="Form.html" title="Form">Form</a></li>
                                <li class=""><a href="Form.BaseField.html" title="Form.BaseField">Form.BaseField</a></li>
                                <li class=""><a href="Record.html" title="Record">Record</a></li>
                                <li class=""><a href="Record.Field.html" title="Record.Field">Record.Field</a></li>
                                <li class=""><a href="RecordSet.html" title="RecordSet">RecordSet</a></li>
                        </ul>
                    </div>

                    <div id="fileList" class="module">
                        <h4>Files</h4>
                        <ul class="content">        
                                <li class="selected"><a href="record.js.html" title="record.js">record.js</a></li>
                        </ul>
                    </div>





            </div>
		</div>
	</div>
	<div id="ft">
        <hr />
        Copyright &copy; 2010 Yahoo! Inc. All rights reserved.
	</div>
</div>
<script type="text/javascript">
    ALL_YUI_PROPS = [{"url": "Record.html#method_accept", "access": "", "host": "Record", "type": "method", "name": "accept"}, {"url": "Form.html#config_action", "access": "", "host": "Form", "type": "config", "name": "action"}, {"url": "Form.html#event_actionChange", "access": "", "host": "Form", "type": "event", "name": "actionChange"}, {"url": "FieldDef.html#method_add", "access": "", "host": "FieldDef", "type": "method", "name": "add"}, {"url": "FieldDefSet.html#method_add", "access": "", "host": "FieldDefSet", "type": "method", "name": "add"}, {"url": "RecordSet.html#method_add", "access": "", "host": "RecordSet", "type": "method", "name": "add"}, {"url": "Record.html#method_addField", "access": "", "host": "Record", "type": "method", "name": "addField"}, {"url": "Form.html#event_beforeActionChange", "access": "", "host": "Form", "type": "event", "name": "beforeActionChange"}, {"url": "FieldDef.html#event_beforeChildrenChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeChildrenChange"}, {"url": "RecordSet.html#event_beforeDataSourceChange", "access": "", "host": "RecordSet", "type": "event", "name": "beforeDataSourceChange"}, {"url": "Record.html#event_beforeDeletedChange", "access": "", "host": "Record", "type": "event", "name": "beforeDeletedChange"}, {"url": "Record.html#event_beforeDirtyChange", "access": "", "host": "Record", "type": "event", "name": "beforeDirtyChange"}, {"url": "Record.Field.html#event_beforeDirtyChange", "access": "", "host": "Record.Field", "type": "event", "name": "beforeDirtyChange"}, {"url": "RecordSet.html#event_beforeFieldDefSetChange", "access": "", "host": "RecordSet", "type": "event", "name": "beforeFieldDefSetChange"}, {"url": "Form.BaseField.html#event_beforeFormIdChange", "access": "", "host": "Form.BaseField", "type": "event", "name": "beforeFormIdChange"}, {"url": "Form.html#event_beforeIndexChange", "access": "", "host": "Form", "type": "event", "name": "beforeIndexChange"}, {"url": "FieldDef.html#event_beforeInitialValueChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeInitialValueChange"}, {"url": "Record.Field.html#event_beforeInitialValueChange", "access": "", "host": "Record.Field", "type": "event", "name": "beforeInitialValueChange"}, {"url": "FieldDef.html#event_beforeLabelChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeLabelChange"}, {"url": "Form.BaseField.html#event_beforeLabelChange", "access": "", "host": "Form.BaseField", "type": "event", "name": "beforeLabelChange"}, {"url": "Form.html#event_beforeMethodChange", "access": "", "host": "Form", "type": "event", "name": "beforeMethodChange"}, {"url": "FieldDef.html#event_beforeNameChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeNameChange"}, {"url": "Record.Field.html#event_beforeNameChange", "access": "", "host": "Record.Field", "type": "event", "name": "beforeNameChange"}, {"url": "Form.BaseField.html#event_beforeNameChange", "access": "", "host": "Form.BaseField", "type": "event", "name": "beforeNameChange"}, {"url": "Record.html#event_beforeNewChange", "access": "", "host": "Record", "type": "event", "name": "beforeNewChange"}, {"url": "Record.Field.html#event_beforeNewChange", "access": "", "host": "Record.Field", "type": "event", "name": "beforeNewChange"}, {"url": "Record.Field.html#event_beforeOldValueChange", "access": "", "host": "Record.Field", "type": "event", "name": "beforeOldValueChange"}, {"url": "Form.html#event_beforePagerChange", "access": "", "host": "Form", "type": "event", "name": "beforePagerChange"}, {"url": "FieldDef.html#event_before_parentChange", "access": "", "host": "FieldDef", "type": "event", "name": "before_parentChange"}, {"url": "FieldDef.html#event_beforeParentChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeParentChange"}, {"url": "FieldDef.html#event_beforePrimaryKeyChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforePrimaryKeyChange"}, {"url": "Form.html#event_beforeRecordSetChange", "access": "", "host": "Form", "type": "event", "name": "beforeRecordSetChange"}, {"url": "FieldDef.html#event_beforeRootChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeRootChange"}, {"url": "RecordSet.html#event_beforeSerializeDirtyOnlyChange", "access": "", "host": "RecordSet", "type": "event", "name": "beforeSerializeDirtyOnlyChange"}, {"url": "RecordSet.html#event_beforeSerializeFormatChange", "access": "", "host": "RecordSet", "type": "event", "name": "beforeSerializeFormatChange"}, {"url": "FieldDef.html#event_beforeServerChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeServerChange"}, {"url": "FieldDef.html#event_beforeServer.formatterChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeServer.formatterChange"}, {"url": "FieldDef.html#event_beforeServer.parserChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeServer.parserChange"}, {"url": "FieldDef.html#event_beforeSortCompareFunctionChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeSortCompareFunctionChange"}, {"url": "RecordSet.html#event_beforeSortCompareFunctionChange", "access": "", "host": "RecordSet", "type": "event", "name": "beforeSortCompareFunctionChange"}, {"url": "RecordSet.html#event_beforeSortedByChange", "access": "", "host": "RecordSet", "type": "event", "name": "beforeSortedByChange"}, {"url": "Form.html#event_beforeSubmitLabelChange", "access": "", "host": "Form", "type": "event", "name": "beforeSubmitLabelChange"}, {"url": "FieldDef.html#event_beforeTypeChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeTypeChange"}, {"url": "FieldDef.html#event_beforeUiChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeUiChange"}, {"url": "FieldDef.html#event_beforeUi.formatterChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeUi.formatterChange"}, {"url": "FieldDef.html#event_beforeUi.parserChange", "access": "", "host": "FieldDef", "type": "event", "name": "beforeUi.parserChange"}, {"url": "Record.Field.html#event_beforeValueChange", "access": "", "host": "Record.Field", "type": "event", "name": "beforeValueChange"}, {"url": "Form.BaseField.html#event_beforeValueChange", "access": "", "host": "Form.BaseField", "type": "event", "name": "beforeValueChange"}, {"url": "Form.html#method__bindForm", "access": "private", "host": "Form", "type": "method", "name": "_bindForm"}, {"url": "Form.html#method__bindPager", "access": "private", "host": "Form", "type": "method", "name": "_bindPager"}, {"url": "Form.BaseField.html#method_bindUI", "access": "", "host": "Form.BaseField", "type": "method", "name": "bindUI"}, {"url": "Form.html#method_bindUI", "access": "", "host": "Form", "type": "method", "name": "bindUI"}, {"url": "Form.html#property__buttons", "access": "private", "host": "Form", "type": "property", "name": "_buttons"}, {"url": "Form.html#property_BUTTON_TEMPLATE", "access": "", "host": "Form", "type": "property", "name": "BUTTON_TEMPLATE"}, {"url": "FieldDef.html#config_children", "access": "", "host": "FieldDef", "type": "config", "name": "children"}, {"url": "FieldDef.html#event_childrenChange", "access": "", "host": "FieldDef", "type": "event", "name": "childrenChange"}, {"url": "Form.html#property__currentRecord", "access": "private", "host": "Form", "type": "property", "name": "_currentRecord"}, {"url": "RecordSet.html#config_dataSource", "access": "", "host": "RecordSet", "type": "config", "name": "dataSource"}, {"url": "RecordSet.html#event_dataSourceChange", "access": "", "host": "RecordSet", "type": "event", "name": "dataSourceChange"}, {"url": "DataType.Converters.html#property_DataType.Converters.dmyDate", "access": "", "host": "DataType.Converters", "type": "property", "name": "DataType.Converters.dmyDate"}, {"url": "DataType.Converters.html#property_DataType.Converters.dmyDate.formatter", "access": "", "host": "DataType.Converters", "type": "property", "name": "DataType.Converters.dmyDate.formatter"}, {"url": "DataType.Converters.html#property_DataType.Converters.dmyDate.parser", "access": "", "host": "DataType.Converters", "type": "property", "name": "DataType.Converters.dmyDate.parser"}, {"url": "DataType.Converters.html#property_DataType.Converters.SQLDate", "access": "", "host": "DataType.Converters", "type": "property", "name": "DataType.Converters.SQLDate"}, {"url": "DataType.Converters.html#property_DataType.Converters.SQLDate.formatter", "access": "", "host": "DataType.Converters", "type": "property", "name": "DataType.Converters.SQLDate.formatter"}, {"url": "DataType.Converters.html#property_DataType.Converters.SQLDate.parser", "access": "", "host": "DataType.Converters", "type": "property", "name": "DataType.Converters.SQLDate.parser"}, {"url": "DataType.Types.html#property_DataType.Types.myDate", "access": "", "host": "DataType.Types", "type": "property", "name": "DataType.Types.myDate"}, {"url": "DataType.Types.html#property_DataType.Types.number", "access": "", "host": "DataType.Types", "type": "property", "name": "DataType.Types.number"}, {"url": "DataType.Types.html#property_DataType.Types.padded", "access": "", "host": "DataType.Types", "type": "property", "name": "DataType.Types.padded"}, {"url": "RecordSet.html#method__defLoadData", "access": "private", "host": "RecordSet", "type": "method", "name": "_defLoadData"}, {"url": "Form.html#method__defRecordIndexChange", "access": "private", "host": "Form", "type": "method", "name": "_defRecordIndexChange"}, {"url": "RecordSet.html#property__defs", "access": "private", "host": "RecordSet", "type": "property", "name": "_defs"}, {"url": "RecordSet.html#method__defSortFn", "access": "private", "host": "RecordSet", "type": "method", "name": "_defSortFn"}, {"url": "Form.html#method__defSubmitForm", "access": "private", "host": "Form", "type": "method", "name": "_defSubmitForm"}, {"url": "Record.html#config_deleted", "access": "", "host": "Record", "type": "config", "name": "deleted"}, {"url": "Record.html#event_deletedChange", "access": "", "host": "Record", "type": "event", "name": "deletedChange"}, {"url": "RecordSet.html#method_destructor", "access": "", "host": "RecordSet", "type": "method", "name": "destructor"}, {"url": "Form.BaseField.html#method_destructor", "access": "", "host": "Form.BaseField", "type": "method", "name": "destructor"}, {"url": "Form.html#method_destructor", "access": "", "host": "Form", "type": "method", "name": "destructor"}, {"url": "Record.html#config_dirty", "access": "", "host": "Record", "type": "config", "name": "dirty"}, {"url": "Record.Field.html#config_dirty", "access": "", "host": "Record.Field", "type": "config", "name": "dirty"}, {"url": "Record.html#event_dirtyChange", "access": "", "host": "Record", "type": "event", "name": "dirtyChange"}, {"url": "Record.Field.html#event_dirtyChange", "access": "", "host": "Record.Field", "type": "event", "name": "dirtyChange"}, {"url": "FieldDefSet.html#method_each", "access": "", "host": "FieldDefSet", "type": "method", "name": "each"}, {"url": "Record.html#method_each", "access": "", "host": "Record", "type": "method", "name": "each"}, {"url": "RecordSet.html#method_eachDef", "access": "", "host": "RecordSet", "type": "method", "name": "eachDef"}, {"url": "Form.html#property__editors", "access": "private", "host": "Form", "type": "property", "name": "_editors"}, {"url": "Form.html#property__editorTypes", "access": "private", "host": "Form", "type": "property", "name": "_editorTypes"}, {"url": "Form.html#method__enableButtons", "access": "private", "host": "Form", "type": "method", "name": "_enableButtons"}, {"url": "RecordSet.html#method__fieldCompare", "access": "private", "host": "RecordSet", "type": "method", "name": "_fieldCompare"}, {"url": "RecordSet.html#config_fieldDefSet", "access": "", "host": "RecordSet", "type": "config", "name": "fieldDefSet"}, {"url": "RecordSet.html#event_fieldDefSetChange", "access": "", "host": "RecordSet", "type": "event", "name": "fieldDefSetChange"}, {"url": "FieldDefSet.html#property_FieldDefSet.TRAVERSE_DEEP", "access": "", "host": "FieldDefSet", "type": "property", "name": "FieldDefSet.TRAVERSE_DEEP"}, {"url": "FieldDefSet.html#property_FieldDefSet.TRAVERSE_LEAVES", "access": "", "host": "FieldDefSet", "type": "property", "name": "FieldDefSet.TRAVERSE_LEAVES"}, {"url": "FieldDefSet.html#property_FieldDefSet.TRAVERSE_SHALLOW", "access": "", "host": "FieldDefSet", "type": "property", "name": "FieldDefSet.TRAVERSE_SHALLOW"}, {"url": "Record.html#property__fields", "access": "private", "host": "Record", "type": "property", "name": "_fields"}, {"url": "Form.html#property_FIELDSET_TEMPLATE", "access": "", "host": "Form", "type": "property", "name": "FIELDSET_TEMPLATE"}, {"url": "Form.BaseField.html#property_FIELD_TEMPLATE", "access": "", "host": "Form.BaseField", "type": "property", "name": "FIELD_TEMPLATE"}, {"url": "Form.html#method__fieldValueChanged", "access": "private", "host": "Form", "type": "method", "name": "_fieldValueChanged"}, {"url": "Form.html#method__fillConverters", "access": "private", "host": "Form", "type": "method", "name": "_fillConverters"}, {"url": "Form.html#property__form", "access": "private", "host": "Form", "type": "property", "name": "_form"}, {"url": "RecordSet.html#method_formalize", "access": "", "host": "RecordSet", "type": "method", "name": "formalize"}, {"url": "Form.html#property__formatters", "access": "private", "host": "Form", "type": "property", "name": "_formatters"}, {"url": "Form.BaseField.html#config_formId", "access": "", "host": "Form.BaseField", "type": "config", "name": "formId"}, {"url": "Form.BaseField.html#event_formIdChange", "access": "", "host": "Form.BaseField", "type": "event", "name": "formIdChange"}, {"url": "Form.html#property_FORM_TEMPLATE", "access": "", "host": "Form", "type": "property", "name": "FORM_TEMPLATE"}, {"url": "FieldDefSet.html#method_get", "access": "", "host": "FieldDefSet", "type": "method", "name": "get"}, {"url": "FieldDef.html#method_getChildCount", "access": "", "host": "FieldDef", "type": "method", "name": "getChildCount"}, {"url": "FieldDefSet.html#method_getDepth", "access": "", "host": "FieldDefSet", "type": "method", "name": "getDepth"}, {"url": "Record.html#method_getField", "access": "", "host": "Record", "type": "method", "name": "getField"}, {"url": "RecordSet.html#method_getFieldDef", "access": "", "host": "RecordSet", "type": "method", "name": "getFieldDef"}, {"url": "Record.html#method_getValue", "access": "", "host": "Record", "type": "method", "name": "getValue"}, {"url": "RecordSet.html#property__index", "access": "private", "host": "RecordSet", "type": "property", "name": "_index"}, {"url": "Form.html#config_index", "access": "", "host": "Form", "type": "config", "name": "index"}, {"url": "Form.html#event_indexChange", "access": "", "host": "Form", "type": "event", "name": "indexChange"}, {"url": "FieldDefSet.html#method__init", "access": "", "host": "FieldDefSet", "type": "method", "name": "_init"}, {"url": "Record.html#method_initializer", "access": "", "host": "Record", "type": "method", "name": "initializer"}, {"url": "Record.Field.html#method_initializer", "access": "", "host": "Record.Field", "type": "method", "name": "initializer"}, {"url": "RecordSet.html#method_initializer", "access": "", "host": "RecordSet", "type": "method", "name": "initializer"}, {"url": "Form.html#method_initializer", "access": "", "host": "Form", "type": "method", "name": "initializer"}, {"url": "FieldDef.html#config_initialValue", "access": "", "host": "FieldDef", "type": "config", "name": "initialValue"}, {"url": "Record.Field.html#config_initialValue", "access": "", "host": "Record.Field", "type": "config", "name": "initialValue"}, {"url": "FieldDef.html#event_initialValueChange", "access": "", "host": "FieldDef", "type": "event", "name": "initialValueChange"}, {"url": "Record.Field.html#event_initialValueChange", "access": "", "host": "Record.Field", "type": "event", "name": "initialValueChange"}, {"url": "Form.BaseField.html#property__input", "access": "private", "host": "Form.BaseField", "type": "property", "name": "_input"}, {"url": "FieldDefSet.html#method_isEmpty", "access": "", "host": "FieldDefSet", "type": "method", "name": "isEmpty"}, {"url": "FieldDefSet.html#method_item", "access": "", "host": "FieldDefSet", "type": "method", "name": "item"}, {"url": "FieldDefSet.html#property__items", "access": "private", "host": "FieldDefSet", "type": "property", "name": "_items"}, {"url": "RecordSet.html#property__items", "access": "private", "host": "RecordSet", "type": "property", "name": "_items"}, {"url": "FieldDefSet.html#property__keys", "access": "private", "host": "FieldDefSet", "type": "property", "name": "_keys"}, {"url": "FieldDef.html#config_label", "access": "", "host": "FieldDef", "type": "config", "name": "label"}, {"url": "Form.BaseField.html#config_label", "access": "", "host": "Form.BaseField", "type": "config", "name": "label"}, {"url": "FieldDef.html#event_labelChange", "access": "", "host": "FieldDef", "type": "event", "name": "labelChange"}, {"url": "Form.BaseField.html#event_labelChange", "access": "", "host": "Form.BaseField", "type": "event", "name": "labelChange"}, {"url": "RecordSet.html#event_loadData", "access": "", "host": "RecordSet", "type": "event", "name": "loadData"}, {"url": "RecordSet.html#event_loadFail", "access": "", "host": "RecordSet", "type": "event", "name": "loadFail"}, {"url": "Form.html#config_method", "access": "", "host": "Form", "type": "config", "name": "method"}, {"url": "Form.html#event_methodChange", "access": "", "host": "Form", "type": "event", "name": "methodChange"}, {"url": "FieldDef.html#config_name", "access": "", "host": "FieldDef", "type": "config", "name": "name"}, {"url": "Record.Field.html#config_name", "access": "", "host": "Record.Field", "type": "config", "name": "name"}, {"url": "Form.BaseField.html#config_name", "access": "", "host": "Form.BaseField", "type": "config", "name": "name"}, {"url": "FieldDef.html#event_nameChange", "access": "", "host": "FieldDef", "type": "event", "name": "nameChange"}, {"url": "Record.Field.html#event_nameChange", "access": "", "host": "Record.Field", "type": "event", "name": "nameChange"}, {"url": "Form.BaseField.html#event_nameChange", "access": "", "host": "Form.BaseField", "type": "event", "name": "nameChange"}, {"url": "Record.html#config_new", "access": "", "host": "Record", "type": "config", "name": "new"}, {"url": "Record.Field.html#config_new", "access": "", "host": "Record.Field", "type": "config", "name": "new"}, {"url": "Record.html#event_newChange", "access": "", "host": "Record", "type": "event", "name": "newChange"}, {"url": "Record.Field.html#event_newChange", "access": "", "host": "Record.Field", "type": "event", "name": "newChange"}, {"url": "Record.Field.html#config_oldValue", "access": "", "host": "Record.Field", "type": "config", "name": "oldValue"}, {"url": "Record.Field.html#event_oldValueChange", "access": "", "host": "Record.Field", "type": "event", "name": "oldValueChange"}, {"url": "Form.BaseField.html#method__onInputChange", "access": "private", "host": "Form.BaseField", "type": "method", "name": "_onInputChange"}, {"url": "Form.html#method__onPagerClick", "access": "private", "host": "Form", "type": "method", "name": "_onPagerClick"}, {"url": "Form.BaseField.html#method__onValueChange", "access": "private", "host": "Form.BaseField", "type": "method", "name": "_onValueChange"}, {"url": "Form.html#config_pager", "access": "", "host": "Form", "type": "config", "name": "pager"}, {"url": "Form.html#event_pagerChange", "access": "", "host": "Form", "type": "event", "name": "pagerChange"}, {"url": "FieldDef.html#property__parent", "access": "private", "host": "FieldDef", "type": "property", "name": "_parent"}, {"url": "FieldDef.html#config__parent", "access": "private", "host": "FieldDef", "type": "config", "name": "_parent"}, {"url": "FieldDef.html#config_parent", "access": "", "host": "FieldDef", "type": "config", "name": "parent"}, {"url": "FieldDefSet.html#property__parent", "access": "private", "host": "FieldDefSet", "type": "property", "name": "_parent"}, {"url": "FieldDef.html#event__parentChange", "access": "", "host": "FieldDef", "type": "event", "name": "_parentChange"}, {"url": "FieldDef.html#event_parentChange", "access": "", "host": "FieldDef", "type": "event", "name": "parentChange"}, {"url": "Form.html#property__parsers", "access": "private", "host": "Form", "type": "property", "name": "_parsers"}, {"url": "FieldDef.html#config_primaryKey", "access": "", "host": "FieldDef", "type": "config", "name": "primaryKey"}, {"url": "FieldDef.html#event_primaryKeyChange", "access": "", "host": "FieldDef", "type": "event", "name": "primaryKeyChange"}, {"url": "Form.html#config_recordSet", "access": "", "host": "Form", "type": "config", "name": "recordSet"}, {"url": "Form.html#event_recordSetChange", "access": "", "host": "Form", "type": "event", "name": "recordSetChange"}, {"url": "RecordSet.html#property_RecordSet.Serializers", "access": "", "host": "RecordSet", "type": "property", "name": "RecordSet.Serializers"}, {"url": "RecordSet.html#method__reIndex", "access": "private", "host": "RecordSet", "type": "method", "name": "_reIndex"}, {"url": "Form.html#method__renderForm", "access": "private", "host": "Form", "type": "method", "name": "_renderForm"}, {"url": "Form.html#method__renderPager", "access": "private", "host": "Form", "type": "method", "name": "_renderPager"}, {"url": "Form.BaseField.html#method_renderUI", "access": "", "host": "Form.BaseField", "type": "method", "name": "renderUI"}, {"url": "Form.html#method_renderUI", "access": "", "host": "Form", "type": "method", "name": "renderUI"}, {"url": "Record.html#method_reset", "access": "", "host": "Record", "type": "method", "name": "reset"}, {"url": "FieldDef.html#property__root", "access": "private", "host": "FieldDef", "type": "property", "name": "_root"}, {"url": "FieldDef.html#config_root", "access": "", "host": "FieldDef", "type": "config", "name": "root"}, {"url": "FieldDefSet.html#property__root", "access": "private", "host": "FieldDefSet", "type": "property", "name": "_root"}, {"url": "FieldDef.html#event_rootChange", "access": "", "host": "FieldDef", "type": "event", "name": "rootChange"}, {"url": "RecordSet.html#method_search", "access": "", "host": "RecordSet", "type": "method", "name": "search"}, {"url": "RecordSet.html#method_sendRequest", "access": "", "host": "RecordSet", "type": "method", "name": "sendRequest"}, {"url": "RecordSet.html#method_serialize", "access": "", "host": "RecordSet", "type": "method", "name": "serialize"}, {"url": "RecordSet.html#config_serializeDirtyOnly", "access": "", "host": "RecordSet", "type": "config", "name": "serializeDirtyOnly"}, {"url": "RecordSet.html#event_serializeDirtyOnlyChange", "access": "", "host": "RecordSet", "type": "event", "name": "serializeDirtyOnlyChange"}, {"url": "RecordSet.html#config_serializeFormat", "access": "", "host": "RecordSet", "type": "config", "name": "serializeFormat"}, {"url": "RecordSet.html#event_serializeFormatChange", "access": "", "host": "RecordSet", "type": "event", "name": "serializeFormatChange"}, {"url": "RecordSet.html#method_serializeURL", "access": "", "host": "RecordSet", "type": "method", "name": "serializeURL"}, {"url": "FieldDef.html#config_server", "access": "", "host": "FieldDef", "type": "config", "name": "server"}, {"url": "FieldDef.html#event_serverChange", "access": "", "host": "FieldDef", "type": "event", "name": "serverChange"}, {"url": "FieldDef.html#config_server.formatter", "access": "", "host": "FieldDef", "type": "config", "name": "server.formatter"}, {"url": "FieldDef.html#event_server.formatterChange", "access": "", "host": "FieldDef", "type": "event", "name": "server.formatterChange"}, {"url": "FieldDef.html#config_server.parser", "access": "", "host": "FieldDef", "type": "config", "name": "server.parser"}, {"url": "FieldDef.html#event_server.parserChange", "access": "", "host": "FieldDef", "type": "event", "name": "server.parserChange"}, {"url": "FieldDefSet.html#method_set", "access": "", "host": "FieldDefSet", "type": "method", "name": "set"}, {"url": "RecordSet.html#method_setFieldDef", "access": "", "host": "RecordSet", "type": "method", "name": "setFieldDef"}, {"url": "RecordSet.html#method_setFieldDefs", "access": "", "host": "RecordSet", "type": "method", "name": "setFieldDefs"}, {"url": "Record.html#method_setValue", "access": "", "host": "Record", "type": "method", "name": "setValue"}, {"url": "FieldDefSet.html#method_size", "access": "", "host": "FieldDefSet", "type": "method", "name": "size"}, {"url": "RecordSet.html#method_sort", "access": "", "host": "RecordSet", "type": "method", "name": "sort"}, {"url": "FieldDef.html#config_sortCompareFunction", "access": "", "host": "FieldDef", "type": "config", "name": "sortCompareFunction"}, {"url": "RecordSet.html#config_sortCompareFunction", "access": "", "host": "RecordSet", "type": "config", "name": "sortCompareFunction"}, {"url": "FieldDef.html#event_sortCompareFunctionChange", "access": "", "host": "FieldDef", "type": "event", "name": "sortCompareFunctionChange"}, {"url": "RecordSet.html#event_sortCompareFunctionChange", "access": "", "host": "RecordSet", "type": "event", "name": "sortCompareFunctionChange"}, {"url": "RecordSet.html#config_sortedBy", "access": "", "host": "RecordSet", "type": "config", "name": "sortedBy"}, {"url": "RecordSet.html#event_sortedByChange", "access": "", "host": "RecordSet", "type": "event", "name": "sortedByChange"}, {"url": "Form.BaseField.html#property__span", "access": "private", "host": "Form.BaseField", "type": "property", "name": "_span"}, {"url": "Form.html#config_submitLabel", "access": "", "host": "Form", "type": "config", "name": "submitLabel"}, {"url": "Form.html#event_submitLabelChange", "access": "", "host": "Form", "type": "event", "name": "submitLabelChange"}, {"url": "Form.html#method__syncForm", "access": "private", "host": "Form", "type": "method", "name": "_syncForm"}, {"url": "Form.html#method_syncUI", "access": "", "host": "Form", "type": "method", "name": "syncUI"}, {"url": "RecordSet.html#method_tabulate", "access": "", "host": "RecordSet", "type": "method", "name": "tabulate"}, {"url": "FieldDefSet.html#property__totalDepth", "access": "private", "host": "FieldDefSet", "type": "property", "name": "_totalDepth"}, {"url": "FieldDefSet.html#method_traverse", "access": "", "host": "FieldDefSet", "type": "method", "name": "traverse"}, {"url": "FieldDef.html#config_type", "access": "", "host": "FieldDef", "type": "config", "name": "type"}, {"url": "FieldDef.html#event_typeChange", "access": "", "host": "FieldDef", "type": "event", "name": "typeChange"}, {"url": "FieldDef.html#config_ui", "access": "", "host": "FieldDef", "type": "config", "name": "ui"}, {"url": "FieldDef.html#event_uiChange", "access": "", "host": "FieldDef", "type": "event", "name": "uiChange"}, {"url": "FieldDef.html#config_ui.formatter", "access": "", "host": "FieldDef", "type": "config", "name": "ui.formatter"}, {"url": "FieldDef.html#event_ui.formatterChange", "access": "", "host": "FieldDef", "type": "event", "name": "ui.formatterChange"}, {"url": "FieldDef.html#config_ui.parser", "access": "", "host": "FieldDef", "type": "config", "name": "ui.parser"}, {"url": "FieldDef.html#event_ui.parserChange", "access": "", "host": "FieldDef", "type": "event", "name": "ui.parserChange"}, {"url": "Record.html#method_undo", "access": "", "host": "Record", "type": "method", "name": "undo"}, {"url": "Record.Field.html#config_value", "access": "", "host": "Record.Field", "type": "config", "name": "value"}, {"url": "Form.BaseField.html#config_value", "access": "", "host": "Form.BaseField", "type": "config", "name": "value"}, {"url": "Record.Field.html#event_valueChange", "access": "", "host": "Record.Field", "type": "event", "name": "valueChange"}, {"url": "Form.BaseField.html#event_valueChange", "access": "", "host": "Form.BaseField", "type": "event", "name": "valueChange"}, {"url": "RecordSet.html#method__valueCompare", "access": "private", "host": "RecordSet", "type": "method", "name": "_valueCompare"}];
</script>
</body>
</html>
