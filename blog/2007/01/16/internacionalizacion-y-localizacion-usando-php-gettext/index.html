<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>
      Comentarios ¬ª Internacionalizaci√≥n y localizaci√≥n: usando PHP-gettext
    </title>
    <meta name="generator" content="WordPress 5.1.1" />
    <link
      type="text/css"
      media="screen"
      rel="stylesheet"
      href="http://www.satyam.com.ar/blog/wp-content/themes/connections/style.css "
    />
    <link
      rel="alternate"
      type="application/rss+xml"
      title="RSS 2.0"
      href="http://www.satyam.com.ar/blog/feed/"
    />
    <link
      rel="alternate"
      type="application/atom+xml"
      title="Atom 0.3"
      href="http://www.satyam.com.ar/blog/feed/atom/"
    />

    <link
      rel="alternate"
      type="application/rss+xml"
      title="Comentarios ¬ª Internacionalizaci√≥n y localizaci√≥n: usando PHP-gettext RSS de los comentarios"
      href="http://www.satyam.com.ar/blog/2007/01/16/internacionalizacion-y-localizacion-usando-php-gettext/feed/"
    />

    <style type="text/css">
      img.wp-smiley,
      img.emoji {
        display: inline !important;
        border: none !important;
        box-shadow: none !important;
        height: 1em !important;
        width: 1em !important;
        margin: 0 0.07em !important;
        vertical-align: -0.1em !important;
        background: none !important;
        padding: 0 !important;
      }
    </style>
    <link
      rel="stylesheet"
      id="wp-block-library-css"
      href="http://www.satyam.com.ar/blog/wp-includes/css/dist/block-library/style.min.css?ver=845e834b3fc80791b38e8f084768285d"
      type="text/css"
      media="all"
    />

    <link
      rel="wlwmanifest"
      type="application/wlwmanifest+xml"
      href="http://www.satyam.com.ar/blog/wp-includes/wlwmanifest.xml"
    />
    <link
      rel="prev"
      title="Internacionalizaci√≥n y localizaci√≥n: usando gettext()"
      href="http://www.satyam.com.ar/blog/2007/01/16/internacionalizacion-y-localizacion-usando-gettext/"
    />
    <link
      rel="next"
      title="Internacionalizaci√≥n y localizaci√≥n: √≠ndice"
      href="http://www.satyam.com.ar/blog/2007/01/17/internacionalizacion-y-localizacion-indice/"
    />

    <link
      rel="canonical"
      href="http://www.satyam.com.ar/blog/2007/01/16/internacionalizacion-y-localizacion-usando-php-gettext/"
    />
  </head>
  <body>
    <div id="rap">
      <div id="header">
        <ul id="topnav">
          <li>
            <a
              href="http://www.satyam.com.ar/blog"
              id="navHome"
              title="Posted Recently"
              accesskey="h"
              >Home |</a
            >
          </li>

          <li>
            <a
              href="http://www.satyam.com.ar/blog/gallery"
              id="navGallery"
              title="Photo Gallery"
              accesskey="g"
              >Fotos |</a
            >
          </li>
          <li><a href="#Buscar" title="Buscar" accesskey="b">Buscar</a></li>
          <!--li><a href="#" id="navContact" title="Contact the Author" accesskey="c">Contact </a></li-->
        </ul>
        <h1>
          <a href="http://www.satyam.com.ar/blog" title="Comentarios"
            >Comentarios</a
          >
        </h1>
        <div id="desc">Comentarios, viajes e historias</div>
      </div>
      <div id="main">
        <div id="content">
          <div class="post">
            <table>
              <tbody>
                <tr>
                  <td>
                    <p class="post-date">mar 16 Ene 2007</p>
                  </td>
                  <td>
                    <div class="post-info">
                      <h2 class="post-title">
                        <a
                          href="http://www.satyam.com.ar/blog/2007/01/16/internacionalizacion-y-localizacion-usando-php-gettext/"
                          rel="bookmark"
                          title="Permanent Link: Internacionalizaci√≥n y localizaci√≥n: usando PHP-gettext"
                          >Internacionalizaci√≥n y localizaci√≥n: usando
                          PHP-gettext</a
                        >
                      </h2>
                      Posted by Satyam under
                      <a
                        href="http://www.satyam.com.ar/blog/category/tecnologia/programacion/"
                        rel="category tag"
                        >Programaci√≥n</a
                      >
                      <br />
                      <a
                        href="http://www.satyam.com.ar/blog/2007/01/16/internacionalizacion-y-localizacion-usando-php-gettext/#comments"
                        >[8] Comments</a
                      >¬†
                    </div>
                  </td>
                  <td></td>
                </tr>
              </tbody>
            </table>
            <div class="post-content">
              <p>
                Dados los problemas de uso de la biblioteca de funciones
                <a
                  title="Manual de PHP: funciones de gettext"
                  target="phpmanual"
                  href="http://es2.php.net/manual/es/ref.gettext.php"
                  ><code>gettext()</code></a
                >
                incorporadas dentro mismo de PHP mencionadas en el art√≠culo
                anterior, mi sugerencia es usar
                <a
                  title="PHP-gettext"
                  target="_blank"
                  href="http://savannah.nongnu.org/projects/php-gettext/"
                  >PHP-gettext</a
                >, un paquete que usan muchas aplicaciones, incluso WordPress,
                en que corre este blog. No s√≥lo su uso es m√°s simple sino que
                tiene un <code>README</code> donde explica r√°pidamente su uso,
                dispone de ejemplos e incluye un archivo para hacer una
                emulaci√≥n completa de la funcionalidad de la biblioteca
                <code>gettext()</code>, aunque vistos los problemas comentados,
                lo que menos puedo recomendar es usar una emulaci√≥n que los
                reproduce hasta el √∫ltimo dolor de cabeza.<span
                  id="more-67"
                ></span>
              </p>
              <p>
                Usar este paquete requiere, b√°sicamente, incluir un par de
                archivos que se proveen, como se ve en el ejemplo:
              </p>
              <p>
                <code
                  ><span style="color: #007700">include </span
                  ><span style="color: #dd0000"
                    >'php-gettext-1.0.7/streams.php'</span
                  ></code
                ><code
                  ><span style="color: #007700"
                    >;<br />
                    include </span
                  ><span style="color: #dd0000"
                    >'php-gettext-1.0.7/gettext.php'</span
                  ><span style="color: #007700">;</span></code
                >
              </p>
              <p>
                La raz√≥n de dividir el paquete en dos archivos es que el segundo
                es el que provee la funcionalidad de
                <code>gettext</code> mientras que el primero es el que lee el
                archivo de traducciones y puede ser reemplazado por otro que
                acceda a este archivo por otro mecanismo.
              </p>
              <p>
                La carga del archivo de traducciones en s√≠ se hace mediante el
                siguiente c√≥digo:
              </p>
              <p>
                <code
                  ><font color="#007700">if (</font
                  ><span style="color: #0000bb">file_exists</span
                  ><span style="color: #007700">(</span
                  ><span style="color: #0000bb">$_SESSION</span
                  ><span style="color: #007700">[</span
                  ><span style="color: #dd0000">'language'</span
                  ><span style="color: #007700">] . </span
                  ><span style="color: #dd0000">'.mo'</span></code
                ><code
                  ><span style="color: #007700">)) {<br /> </span
                  ><span style="color: #0000bb"> $gettext_tables </span
                  ><span style="color: #007700">= new </span
                  ><span style="color: #0000bb">gettext_reader</span
                  ><span style="color: #007700"
                    >(<br />
                    new </span
                  ><span style="color: #0000bb">CachedFileReader</span
                  ><span style="color: #007700">(</span
                  ><span style="color: #0000bb">$_SESSION</span
                  ><span style="color: #007700">[</span
                  ><span style="color: #dd0000">'language'</span
                  ><span style="color: #007700">] . </span
                  ><span style="color: #dd0000">'.mo'</span></code
                ><code
                  ><span style="color: #007700"
                    >)<br />
                    );<br /> </span
                  ><span style="color: #0000bb"> $gettext_tables</span
                  ><span style="color: #007700">-></span
                  ><span style="color: #0000bb">load_tables</span></code
                ><span style="color: #007700"
                  ><code
                    >();<br />
                    }</code
                  ></span
                >
              </p>
              <p>
                Como se puede ver, el archivo de traducciones se puede ubicar
                donde uno prefiera, el control es total. En este caso, primero
                verifico que exista y luego genero una instancia del
                <code>CachedFileReader</code> indic√°ndole la ubicaci√≥n del
                archivo. A su vez, este objeto se usa en el constructor de
                <code>gettext_reader</code>, que es el objeto que proveer√° toda
                la funcionalidad de <code>gettext</code>. Finalmente, se invoca
                el m√©todo que carga las tablas. El paquete permite tanto cachear
                las tablas en memoria (predeterminado) o accederlas directamente
                a disco, en cuyo caso el <code>FileReader</code> almacena los
                punteros a las traducciones accedi√©ndolas directamente del
                archivo. Esto se determina mediante un argumento opcional en el
                lector o instanciando distintos lectores.
              </p>
              <p>
                La idea de usar el nombre <code>_()</code> para la funci√≥n de
                traducci√≥n es muy bueno, pero como ya est√° tomado y no es
                posible redefinirlo, usamos <code>__()</code>, que es igualmente
                breve y legible, donde la legibilidad est√° en la facilidad de
                leer los textos a traducir, pues a la parte ejecutable no le
                afecta.
              </p>
              <pre><span style="color: #007700">function </span><span style="color: #0000bb">__</span><span style="color: #007700">(</span><span style="color: #0000bb">$texto</span><span style="color: #007700">) {
global </span><span style="color: #0000bb">$gettext_tables</span><span style="color: #007700">;</span><span style="color: #007700">

if (</span><span style="color: #0000bb">is_null</span><span style="color: #007700">(</span><span style="color: #0000bb">$gettext_tables</span><span style="color: #007700">)) return </span><span style="color: #0000bb">$texto</span><span style="color: #007700">;
else return </span><span style="color: #0000bb">$gettext_tables</span><span style="color: #007700">-></span><span style="color: #0000bb">translate</span><span style="color: #007700">(</span><span style="color: #0000bb">$texto</span><span style="color: #007700">);
}</span></pre>
              <p>
                Esta funci√≥n verifica que el objeto haya sido instanciado con
                √©xito y si es as√≠, llama al m√©todo . En cualquier caso, ya fuera
                que la traducci√≥n no existiera, un texto individual o el archivo
                de traducciones completo, la funci√≥n devuelve el texto original
                con lo que, al menos, el usuario no se queda mirando una
                pantalla en blanco.A partir de all√≠, el resto del programa es
                simple, cada vez que se quiere usar una cadena localizable, se
                la encierra en una llamada a la funci√≥n y listo.Probablemente ya
                hayan notado que no es necesario inventar identificadores para
                las cadenas a traducir, el texto en el idioma original es la
                clave de b√∫squeda por lo que en el caso de no haber una
                traducci√≥n, siempre se dispone de alg√∫n texto, aunque fuera en
                un idioma que no corresponde al pedido por el usuario.
              </p>
              <p>
                A todo esto, no hemos aclarado c√≥mo se genera un archivo
                <code>.mo</code>, ni hemos explicado la estructura del archivo
                de traducciones.
              </p>
              <p>
                La clave del uso del paquete <code>gettext</code> es una serie
                de programas que se encargan de rastrear los fuentes buscando
                cadenas a traducir y actualizarlas cuando cambian. Existen
                programas con interfaces gr√°ficas para facilitar esta tarea, tal
                como
                <a title="poEdit" target="_blank" href="http://www.poedit.net/"
                  >poEdit</a
                >, que est√° disponible para Linux, Macintosh y Windows y,
                obviamente, internacionalizado, aunque tambi√©n est√°n los
                comandos de l√≠nea que existen en todas las plataformas Linux
                (aunque pueden no estar instalados por defecto) y tambi√©n hay
                versiones para Windows (<a
                  title="gnuwin32 en SourceForge"
                  target="_blank"
                  href="http://gnuwin32.sourceforge.net/packages/gettext.htm"
                  >gnuwin32</a
                >).
              </p>
              <p>El proceso, resumido, es el siguiente:</p>
              <p>
                1) se extraen las cadenas a traducir con el programa
                <code>xgettext</code>:
              </p>
              <p>
                <code
                  >xgettext *.php --output=index.pot --keyword=__
                  --from-code=ISO-8859-1</code
                >
              </p>
              <p>
                En todos los casos he usado las versiones largas de las opciones
                para que sean m√°s claras. A <code>xgettext</code> se le indica
                el o los fuentes de los que extraer las cadenas. Se le debe
                indicar el archivo de salida o redireccionar de la salida
                est√°ndar, el set de caracteres de los fuentes y, en nuestro
                caso, dado que hemos usado el nombre de funci√≥n
                <code>__()</code> en lugar de <code>_()</code> se le debe
                indicar expresamente que busque este nombre de funci√≥n. El
                programa reconoce el lenguaje de los fuentes por su extensi√≥n e
                interpreta la sint√°xis seg√∫n se trate, pero si se hubiera usado
                alguna extensi√≥n que no reconociera, se le puede indicar
                expresamente.
              </p>
              <p>
                En este caso la salida ha sido un archivo <code>.pot</code>,
                extensi√≥n que corresponde a un <em>‚Äòtemplate‚Äô</em> o ‚Äòmodelo‚Äô de
                la traducci√≥n. Es habitual entregar este archivo de modelo como
                parte de una aplicaci√≥n para que el traductor disponga de un
                original limpio a partir del cual comenzar su trabajo.
              </p>
              <p>2) Se genera un archivo de traducci√≥n a partir del modelo:</p>
              <p>
                <code
                  >msginit --input=index.pot --output=en.po --locale=en</code
                >
              </p>
              <p>
                Este programa simplemente toma el archivo <code>.pot</code> que
                se le indica y genera un archivo <code>.po</code> para la
                localizaci√≥n que se indica. Completa varios de los campos con
                datos que obtiene del sistema, por ejemplo, el nombre de
                usuario, la fecha de la traducci√≥n y pone como traducci√≥n el
                mismo texto que el original. El traductor puede tanto comenzar a
                partir del archivo <code>.pot</code> o del
                <code>.po</code> seg√∫n prefiera.
              </p>
              <p>
                3) Traducci√≥n. Esta se puede hacer con cualquier editor de texto
                simple. Existen macros para EMACS y hay IDEs que tienen modos de
                edici√≥n espec√≠ficos para este tipo de archivo. Aplicaciones como
                <a title="poEdit" target="_blank" href="http://www.poedit.net/"
                  >poEdit</a
                >
                disponen de su propio editor. Este programa en particular
                permite guardar una base de datos de traducciones de tal manera
                que en sucesivas traducciones puede intentar por s√≠ solo
                traducir parte de los textos.
              </p>
              <p>
                De todas formas, el proceso es simple, el texto tras la palabra
                clave msgid es el original, el que sigue a msgstr es la
                traducci√≥n. Para facilitar la tarea, los comentarios que
                preceden a cada cadena muestran el fuente y n√∫mero de l√≠nea en
                que ha encontrado esta cadena. El programa
                <code>xgettext</code> se encarga de identificar cadenas
                duplicadas por s√≠ mismo.
              </p>
              <p>4) Compilaci√≥n:</p>
              <p><code>msgfmt en.po --output-file=en.mo</code></p>
              <p>
                Esta es la parte m√°s simple del proceso, compilarlo implica
                llamar a <code>msgfmt</code>, indicarle el nombre del archivo de
                entrada y el de salida.
              </p>
              <p>
                Esta √∫ltima etapa puede automatizarse f√°cilmente dentro de un
                archivo <code>makefile</code>, no as√≠ las primeras. En
                particular, llamar a <code>msginit</code> una segunda vez
                destruir√≠a el archivo de traducciones ya hecho. El paquete
                dispone de un mecanismo de actualizaci√≥n a trav√©s del programa
                <code>msgmerge</code>. El proceso de actualizaci√≥n es similar al
                ya descripto, comenzando por el punto 1 hasta el 4, excepto que
                en lugar del paso 2 anterior se utiliza el comando siguiente:
              </p>
              <p><code>msgmerge --update en.po index.pot</code></p>
              <p>
                El comando <code>msgmerge</code> lee tanto el
                <code>.pot</code> como el <code>.po</code> y actualiza este
                √∫ltimo sin da√±ar las traducciones ya presentes.
              </p>
              <p>
                Advi√©rtase que solo es necesario un √∫nico archivo de
                traducciones para toda una aplicaci√≥n, no es necesaria un
                archivo asociado a cada fuente, de all√≠ que para el modelo us√©
                el nombre <code>index.pot</code>, adoptando index como
                predeterminado, aunque no esto no es necesario.
              </p>
              <p>
                Gettext tiene varias otras facilidades que no he mencionado,
                como ser el manejo de traducciones ambiguas (<em>fuzzy</em>),
                plurales (permite ofrecer distintas traducciones seg√∫n el n√∫mero
                de √≠tems que se le indiquen) y m√∫ltiples dominios, lo cual es
                indispensable cuando se utilizan paquetes de diferentes or√≠genes
                o <em>‚Äòplugins‚Äô</em>, cada uno con sus conjunto de traducciones
                independientes. Para esto se recomienda ver la documentaci√≥n
                original.
              </p>
              <p>
                Viene de:
                <a
                  title="Enlace permanente: Internacionalizaci√≥n y localizaci√≥n: usando gettext()"
                  rel="bookmark"
                  href="http://www.satyam.com.ar/blog/2007/01/16/internacionalizacion-y-localizacion-usando-gettext/"
                  >Internacionalizaci√≥n y localizaci√≥n: usando gettext()</a
                >
              </p>
              <p>
                Contin√∫a en:
                <a
                  title="Enlace permanente: Internacionalizaci√≥n y localizaci√≥n: bases de datos"
                  rel="bookmark"
                  href="http://www.satyam.com.ar/blog/2007/01/17/internacionalizacion-y-localizacion-bases-de-datos/"
                  >Internacionalizaci√≥n y localizaci√≥n: bases de datos</a
                >
              </p>
              <p>
                Indice:
                <a
                  title="Enlace permanente: Internacionalizaci√≥n y Localizaci√≥n: √≠ndice"
                  rel="bookmark"
                  href="http://www.satyam.com.ar/blog/2007/01/17/internacionalizacion-y-localizacion-indice/"
                  >Internacionalizaci√≥n y Localizaci√≥n: √≠ndice</a
                >
              </p>
              <p><!--2f464a23d485efabb75aa5b7753bbb3b--></p>
              <p><!--3e19431f570a5fb0e5f99ff7d93d461b--></p>
              <div class="post-info"></div>
              <div class="post-footer">¬†</div>
            </div>
            <!-- You can start editing here. -->

            <h3 id="comments">
              8 Responses to ‚ÄúInternacionalizaci√≥n y localizaci√≥n: usando
              PHP-gettext‚Äù
            </h3>

            <ol class="commentlist">
              <li class="alt" id="comment-4412">
                <cite
                  ><a href="http://aurea.es" rel="external nofollow" class="url"
                    >Quasi</a
                  ></cite
                >
                Says:
                <br />

                <small class="commentmetadata"
                  ><a href="#comment-4412" title=""
                    >agosto 8th, 2007 at 21:56</a
                  >
                </small>

                <p>Realmente increible.</p>
                <p>
                  El tutorial que has hecho sobre internacionalizaciÔøΩn es
                  sencillamente magnifico.
                </p>
                <p>Gracias por tu labor y Felicidades por el resultado.</p>
                <p>üòâ</p>
              </li>

              <li class="" id="comment-15653">
                <cite>Ana</cite> Says:
                <br />

                <small class="commentmetadata"
                  ><a href="#comment-15653" title=""
                    >abril 22nd, 2008 at 19:46</a
                  >
                </small>

                <p>Muchas gracias por tus explicaciones, :-))</p>
              </li>

              <li class="alt" id="comment-16140">
                <cite
                  ><a
                    href="http://www.javierav.com"
                    rel="external nofollow"
                    class="url"
                    >Javier</a
                  ></cite
                >
                Says:
                <br />

                <small class="commentmetadata"
                  ><a href="#comment-16140" title="">mayo 2nd, 2008 at 1:14</a>
                </small>

                <p>Hola.</p>
                <p>
                  Gracias por este mini tutorial, me ha quedado todo mucho mÔøΩs
                  claro.
                </p>
                <p>Saludos.</p>
              </li>

              <li class="" id="comment-20960">
                <cite>radt</cite> Says:
                <br />

                <small class="commentmetadata"
                  ><a href="#comment-20960" title=""
                    >agosto 8th, 2008 at 11:46</a
                  >
                </small>

                <p>Hola,</p>
                <p>
                  Por alguna razon que no podido identificar todavia, no me
                  instancia el objeto.<br />
                  Con debug he verificado que entra en el if file exists, pero
                  no lo instancia.
                </p>
                <p>Alguna idea de donde debo buscar?</p>
                <p>gracias</p>
              </li>

              <li class="alt" id="comment-22007">
                <cite>joropo</cite> Says:
                <br />

                <small class="commentmetadata"
                  ><a href="#comment-22007" title=""
                    >agosto 28th, 2008 at 17:35</a
                  >
                </small>

                <p>muchÔøΩsimas gracias por la data.</p>
                <p>
                  el enlace a poEdit tiene un error: es poedit.net y no .org
                </p>
              </li>

              <li class="" id="comment-22008">
                <cite
                  ><a
                    href="http://www.satyam.com.ar"
                    rel="external nofollow"
                    class="url"
                    >Satyam</a
                  ></cite
                >
                Says:
                <br />

                <small class="commentmetadata"
                  ><a href="#comment-22008" title=""
                    >agosto 28th, 2008 at 17:59</a
                  >
                </small>

                <p>Gracias por la correciÔøΩn Joropo, ya estÔøΩ actualizado.</p>
              </li>

              <li class="alt" id="comment-35362">
                <cite
                  ><a
                    href="http://janckos.net"
                    rel="external nofollow"
                    class="url"
                    >Janckos</a
                  ></cite
                >
                Says:
                <br />

                <small class="commentmetadata"
                  ><a href="#comment-35362" title=""
                    >mayo 22nd, 2009 at 15:19</a
                  >
                </small>

                <p>Muy buen articulo, gracias!.</p>
              </li>

              <li class="" id="comment-51806">
                <cite>Jose Alberto</cite> Says:
                <br />

                <small class="commentmetadata"
                  ><a href="#comment-51806" title=""
                    >diciembre 23rd, 2011 at 15:27</a
                  >
                </small>

                <p>
                  Muchas gracias por la informaci√≥n, me ha sido de gran ayuda.
                </p>
              </li>
            </ol>
          </div>
          <p align="center"></p>
        </div>
        <div id="sidebar">
          <h2>Archived Entry</h2>
          <ul>
            <li><strong>Post Date :</strong></li>
            <li>martes, Ene 16th, 2007 at 21:48</li>
            <li><strong>Categor√≠a :</strong></li>
            <li>
              <a
                href="http://www.satyam.com.ar/blog/category/tecnologia/programacion/"
                rel="category tag"
                >Programaci√≥n</a
              >
            </li>
            <li><strong>Do More :</strong></li>
            <li>Both comments and pings are currently closed.</li>
          </ul>
        </div>

        <p id="footer">
          Design Downloaded from
          <a href="http://www.vanillamist.com" title="Vanilla Mist"
            >www.vanillamist.com</a
          >
        </p>
      </div>
    </div>
  </body>
</html>
